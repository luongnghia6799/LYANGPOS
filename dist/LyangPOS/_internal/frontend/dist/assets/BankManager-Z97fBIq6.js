import{r as l,a9 as Q,j as e}from"./vendor-C23Namvk.js";import{a as h}from"./vendor-utils-C44aPrMG.js";import{c as i,d as f,b as M,P}from"./index-DXxzNUOO.js";import{T as Y}from"./Toast-rpGoMLC9.js";import{C as J}from"./ConfirmModal-BTMhiinM.js";import{e as C,O as Z,aa as _,af as ee,aD as te,_ as ae,a as se,$ as F,b as le,a8 as R,a9 as G,X as I}from"./vendor-icons-C8Df64wb.js";import{A as T,m as u}from"./vendor-framer-DVZK1f_z.js";function he(){const[c,S]=l.useState([]),[z,E]=l.useState([]),[s,k]=l.useState(null),[O,A]=l.useState(!1),[j,o]=l.useState(null),[p,y]=l.useState(null),[b,V]=l.useState(""),[m,X]=l.useState("all"),[K,g]=l.useState(!1),[B,N]=l.useState(!1),[w,D]=l.useState("add"),[n,d]=l.useState({bank_name:"",account_number:"",account_holder:"",balance:0}),[a,x]=l.useState({account_id:"",amount:0,type:"Deposit",note:""});l.useEffect(()=>{v()},[]),l.useEffect(()=>{c.length>0&&!s&&k(c[0])},[c]),l.useEffect(()=>{s&&L(s.id)},[s]);const v=async()=>{try{const t=await h.get("/api/bank-accounts");S(t.data)}catch(t){console.error(t)}},L=async t=>{A(!0);try{const r=await h.get("/api/bank-transactions",{params:{account_id:t}});E(r.data)}catch(r){console.error(r)}finally{A(!1)}},H=Q.useMemo(()=>z.filter(t=>{const r=(t.note||"").toLowerCase().includes(b.toLowerCase())||(t.partner_name||"").toLowerCase().includes(b.toLowerCase()),q=m==="all"||t.type===m;return r&&q}),[z,b,m]),U=async()=>{if(!n.bank_name||!n.account_number){o({message:"Vui lòng nhập tên ngân hàng và số tài khoản",type:"error"});return}try{w==="add"?(await h.post("/api/bank-accounts",n),o({message:"Đã thêm tài khoản thành công!",type:"success"})):(await h.put(`/api/bank-accounts/${s.id}`,n),o({message:"Đã cập nhật tài khoản!",type:"success"})),v(),g(!1),d({bank_name:"",account_number:"",account_holder:"",balance:0})}catch{o({message:"Lỗi khi lưu tài khoản",type:"error"})}},W=t=>{y({title:"Xác nhận xóa tài khoản",message:"Xóa tài khoản này sẽ xóa toàn bộ lịch sử giao dịch liên quan. Bạn có chắc chắn muốn thực hiện?",onConfirm:async()=>{try{await h.delete(`/api/bank-accounts/${t}`),S(c.filter(r=>r.id!==t)),s?.id===t&&k(null),o({message:"Đã xóa tài khoản",type:"success"})}catch{o({message:"Lỗi khi xóa tài khoản",type:"error"})}y(null)},type:"danger"})},$=async()=>{if(!a.amount||!a.account_id){o({message:"Vui lòng nhập số tiền và chọn tài khoản",type:"error"});return}try{await h.post("/api/bank-transactions",a),o({message:"Đã ghi nhận giao dịch!",type:"success"}),v(),s?.id===parseInt(a.account_id)&&L(s.id),N(!1),x({...a,amount:0,note:""})}catch{o({message:"Lỗi khi thực hiện giao dịch",type:"error"})}};return e.jsxs("div",{className:"p-4 w-full space-y-10 min-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-black text-[#1e293b] dark:text-white uppercase tracking-tighter flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-3xl text-white shadow-xl shadow-blue-500/20",children:e.jsx(C,{size:32})}),"TÀI KHOẢN NGÂN HÀNG"]}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-bold mt-2 uppercase tracking-[0.1em] text-xs",children:"Quản lý dòng tiền và các tài khoản ngân hàng của bạn"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>{D("add"),d({bank_name:"",account_number:"",account_holder:"",balance:0}),g(!0)},className:"px-6 py-3 bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-100 font-black rounded-2xl border-2 border-slate-100 dark:border-slate-700 hover:border-blue-500 hover:text-blue-600 transition-all flex items-center gap-2 shadow-lg",children:[e.jsx(Z,{size:20})," THÊM TÀI KHOẢN"]}),e.jsxs("button",{onClick:()=>{x({...a,account_id:s?.id||c[0]?.id||""}),N(!0)},className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-black rounded-2xl shadow-xl shadow-blue-500/20 hover:scale-[1.02] active:scale-95 transition-all flex items-center gap-2",children:[e.jsx(_,{size:20})," LẬP GIAO DỊCH"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.jsx(T,{mode:"popLayout",children:c.map(t=>e.jsxs(u.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9},onClick:()=>k(t),className:i("relative p-8 rounded-[3rem] cursor-pointer transition-all duration-500 overflow-hidden group border-4",s?.id===t.id?"bg-gradient-to-br from-slate-900 to-slate-800 border-blue-500/50 shadow-2xl shadow-blue-500/20":"bg-white dark:bg-slate-900 border-slate-100 dark:border-slate-800 hover:border-slate-200 dark:hover:border-slate-700 shadow-xl"),children:[e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-10",children:[e.jsx("div",{className:i("w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg",s?.id===t.id?"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-800 text-blue-600"),children:e.jsx(ee,{size:28})}),e.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),D("edit"),d({...t}),g(!0)},className:"p-2 bg-white/10 hover:bg-white/20 rounded-xl text-white",children:e.jsx(te,{size:16})}),e.jsx("button",{onClick:r=>{r.stopPropagation(),W(t.id)},className:"p-2 bg-rose-500/20 hover:bg-rose-500/40 rounded-xl text-rose-500",children:e.jsx(ae,{size:16})})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:i("text-xs font-black uppercase tracking-[0.2em]",s?.id===t.id?"text-blue-400":"text-slate-400"),children:t.bank_name}),e.jsx("p",{className:i("text-2xl font-black tracking-tight",s?.id===t.id?"text-white":"text-slate-800 dark:text-white"),children:t.account_number}),e.jsx("p",{className:i("text-[10px] font-black uppercase opacity-60",s?.id===t.id?"text-slate-300":"text-slate-500"),children:t.account_holder||"CHƯA CẬP NHẬT TÊN"})]}),e.jsxs("div",{className:"mt-10 pt-6 border-t border-slate-500/20",children:[e.jsx("div",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1",children:"Số dư khả dụng"}),e.jsxs("div",{className:i("text-4xl font-black tracking-tighter tabular-nums",s?.id===t.id?"text-white":"text-blue-600"),children:[f(t.balance)," ",e.jsx("span",{className:"text-xl",children:"đ"})]})]})]}),e.jsx("div",{className:"absolute -right-10 -bottom-10 opacity-5 group-hover:opacity-10 transition-opacity transform group-hover:rotate-12 duration-700",children:e.jsx(C,{size:200})})]},t.id))})}),s&&e.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/60 dark:bg-slate-900/60 backdrop-blur-xl border-2 border-slate-100 dark:border-slate-800 p-10 rounded-[4rem] shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-slate-100 dark:bg-slate-800 rounded-2xl text-slate-600",children:e.jsx(se,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-slate-800 dark:text-white uppercase tracking-tight",children:"Lịch sử giao dịch"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 font-bold text-[10px] uppercase",children:"Bản liệt kê các thay đổi số dư gần đây"})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("select",{className:"px-6 py-3 bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-blue-500 rounded-2xl outline-none font-bold text-sm transition-all dark:text-white",value:m,onChange:t=>X(t.target.value),children:[e.jsx("option",{value:"all",children:"Tất cả loại giao dịch"}),e.jsx("option",{value:"Deposit",children:"Nạp tiền / Thu hộ"}),e.jsx("option",{value:"Withdrawal",children:"Rút tiền / Chi hộ"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Tìm theo ghi chú, đối tác...",className:"pl-12 pr-6 py-3 bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-blue-500 focus:bg-white rounded-2xl outline-none font-bold text-sm w-80 transition-all dark:text-white",value:b,onChange:t=>V(t.target.value)})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] border-b-2 border-slate-50 dark:border-slate-800",children:[e.jsx("th",{className:"px-6 py-4 text-left font-black",children:"Thời gian"}),e.jsx("th",{className:"px-6 py-4 text-left font-black",children:"Phân loại"}),e.jsx("th",{className:"px-6 py-4 text-left font-black",children:"Ghi chú"}),e.jsx("th",{className:"px-6 py-4 text-right font-black",children:"Số tiền (đ)"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 dark:divide-slate-800",children:O?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"py-20 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(_,{size:40,className:"animate-spin text-blue-500/20"}),e.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Đang tải dữ liệu..."})]})})}):H.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"py-20 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"p-6 bg-slate-50 dark:bg-slate-800/40 rounded-full text-slate-200",children:e.jsx(F,{size:60})}),e.jsx("span",{className:"text-[10px] font-black text-slate-300 uppercase tracking-[0.2em]",children:"Không tìm thấy giao dịch phù hợp"})]})})}):H.map((t,r)=>e.jsxs(u.tr,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:r*.03},className:"hover:bg-slate-50/50 dark:hover:bg-slate-800/30 transition-colors group",children:[e.jsx("td",{className:"px-6 py-5",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 dark:bg-slate-800 rounded-xl flex items-center justify-center text-slate-400 group-hover:text-blue-500 transition-colors",children:e.jsx(le,{size:18})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-black text-slate-800 dark:text-slate-200",children:M(t.date).split(" ")[0]}),e.jsx("div",{className:"text-[10px] font-bold text-slate-400",children:M(t.date).split(" ")[1]})]})]})}),e.jsx("td",{className:"px-6 py-5",children:e.jsxs("div",{className:i("inline-flex items-center gap-2 px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest",t.type==="Deposit"?"bg-emerald-100/50 text-emerald-600 dark:bg-emerald-500/10 dark:text-emerald-400":"bg-rose-100/50 text-rose-600 dark:bg-rose-500/10 dark:text-rose-400"),children:[t.type==="Deposit"?e.jsx(R,{size:14}):e.jsx(G,{size:14}),t.type==="Deposit"?"Nạp tiền":"Rút tiền"]})}),e.jsx("td",{className:"px-6 py-5",children:e.jsxs("div",{className:"text-sm font-bold text-slate-600 dark:text-slate-400 max-w-md truncate",children:[t.note||"Không có ghi chú",t.partner_name&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-blue-50 dark:bg-blue-900/20 text-blue-500 rounded-md text-[9px] uppercase font-black",children:t.partner_name})]})}),e.jsx("td",{className:"px-6 py-5 text-right tabular-nums",children:e.jsxs("div",{className:i("text-lg font-black tracking-tight",t.type==="Deposit"?"text-emerald-600":"text-rose-600"),children:[t.type==="Deposit"?"+":"-",f(t.amount)]})})]},t.id))})]})})]}),e.jsx(P,{children:e.jsx(T,{children:K&&e.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:e.jsxs(u.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-[3.5rem] shadow-2xl overflow-hidden border-2 border-blue-500/20",children:[e.jsxs("div",{className:"p-10 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-gradient-to-r from-blue-50 to-white dark:from-blue-900/10 dark:to-slate-900",children:[e.jsxs("h2",{className:"text-2xl font-black text-slate-800 dark:text-white uppercase tracking-tight flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-xl text-white shadow-lg",children:e.jsx(C,{size:20})}),w==="add"?"Thêm tài khoản mới":"Cập nhật tài khoản"]}),e.jsx("button",{onClick:()=>g(!1),className:"p-2 hover:bg-slate-100 rounded-xl transition-all",children:e.jsx(I,{size:24})})]}),e.jsxs("div",{className:"p-10 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Tên ngân hàng"}),e.jsx("input",{type:"text",className:"w-full p-4 bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-blue-500 rounded-2xl outline-none font-bold dark:text-white transition-all shadow-inner",placeholder:"VD: Vietcombank, Techcombank...",value:n.bank_name,onChange:t=>d({...n,bank_name:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Số tài khoản"}),e.jsx("input",{type:"text",className:"w-full p-4 bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-blue-500 rounded-2xl outline-none font-bold dark:text-white transition-all shadow-inner",placeholder:"0123456789...",value:n.account_number,onChange:t=>d({...n,account_number:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Chủ tài khoản"}),e.jsx("input",{type:"text",className:"w-full p-4 bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-blue-500 rounded-2xl outline-none font-bold dark:text-white transition-all shadow-inner",placeholder:"NGUYEN VAN A...",value:n.account_holder,onChange:t=>d({...n,account_holder:t.target.value})})]}),w==="add"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Số dư khởi tạo"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:"w-full p-4 pr-16 bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-blue-500 rounded-2xl outline-none font-black text-2xl text-right dark:text-white transition-all shadow-inner",placeholder:"0",value:f(n.balance),onChange:t=>d({...n,balance:parseFloat(t.target.value.replace(/,/g,""))||0})}),e.jsx("span",{className:"absolute right-6 top-1/2 -translate-y-1/2 font-black text-slate-400 text-sm",children:"đ"})]})]}),e.jsx("button",{onClick:U,className:"w-full py-5 bg-gradient-to-r from-blue-600 to-indigo-700 text-white rounded-3xl font-black text-lg shadow-xl shadow-blue-500/20 hover:scale-[1.02] active:scale-95 transition-all mt-4",children:"XÁC NHẬN LƯU"})]})]})})})}),e.jsx(P,{children:e.jsx(T,{children:B&&e.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:e.jsxs(u.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-[3.5rem] shadow-2xl overflow-hidden border-2 border-blue-500/20",children:[e.jsxs("div",{className:"p-10 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-gradient-to-r from-blue-50 to-white dark:from-blue-900/10 dark:to-slate-900",children:[e.jsxs("h2",{className:"text-2xl font-black text-slate-800 dark:text-white uppercase tracking-tight flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-xl text-white shadow-lg",children:e.jsx(_,{size:20})}),"Lập giao dịch ngân hàng"]}),e.jsx("button",{onClick:()=>N(!1),className:"p-2 hover:bg-slate-100 rounded-xl transition-all",children:e.jsx(I,{size:24})})]}),e.jsxs("div",{className:"p-10 space-y-6",children:[e.jsxs("div",{className:"p-2 bg-slate-50 dark:bg-slate-800/40 rounded-3xl flex border-2 border-slate-100 dark:border-slate-800",children:[e.jsxs("button",{onClick:()=>x({...a,type:"Deposit"}),className:i("flex-1 py-4 rounded-2xl font-black text-xs uppercase tracking-widest transition-all gap-2 flex items-center justify-center",a.type==="Deposit"?"bg-white dark:bg-slate-700 text-emerald-600 shadow-md":"text-slate-500 hover:text-slate-700"),children:[e.jsx(R,{size:16})," NẠP TIỀN"]}),e.jsxs("button",{onClick:()=>x({...a,type:"Withdrawal"}),className:i("flex-1 py-4 rounded-2xl font-black text-xs uppercase tracking-widest transition-all gap-2 flex items-center justify-center",a.type==="Withdrawal"?"bg-white dark:bg-slate-700 text-rose-600 shadow-md":"text-slate-500 hover:text-slate-700"),children:[e.jsx(G,{size:16})," RÚT TIỀN"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Chọn tài khoản"}),e.jsxs("select",{className:"w-full p-4 bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-blue-500 rounded-2xl outline-none font-bold dark:text-white appearance-none transition-all shadow-inner",value:a.account_id,onChange:t=>x({...a,account_id:t.target.value}),children:[e.jsx("option",{value:"",children:"Chọn một tài khoản..."}),c.map(t=>e.jsxs("option",{value:t.id,children:[t.bank_name," - ",t.account_number]},t.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Số tiền giao dịch"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:i("w-full p-6 pr-16 bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-blue-500 rounded-3xl outline-none font-black text-4xl text-right transition-all shadow-inner",a.type==="Deposit"?"text-emerald-600":"text-rose-600"),placeholder:"0",value:f(a.amount),onChange:t=>x({...a,amount:parseFloat(t.target.value.replace(/,/g,""))||0}),onFocus:t=>t.target.select()}),e.jsx("span",{className:"absolute right-6 top-1/2 -translate-y-1/2 font-black text-slate-400 text-sm",children:"đ"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Nội dung ghi chú"}),e.jsx("textarea",{className:"w-full p-4 bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-blue-500 rounded-2xl outline-none font-bold dark:text-white transition-all shadow-inner h-24 resize-none",placeholder:"Ghi chú thêm về giao dịch này...",value:a.note,onChange:t=>x({...a,note:t.target.value})})]})]}),e.jsx("button",{onClick:$,className:i("w-full py-6 text-white rounded-[2.5rem] font-black text-xl shadow-xl hover:scale-[1.02] active:scale-95 transition-all mt-4 uppercase tracking-widest",a.type==="Deposit"?"bg-emerald-600 shadow-emerald-500/20":"bg-rose-600 shadow-rose-500/20"),children:"XÁC NHẬN GIAO DỊCH"})]})]})})})}),j&&e.jsx(Y,{message:j.message,type:j.type,onClose:()=>o(null)}),p&&e.jsx(J,{title:p.title,message:p.message,onConfirm:p.onConfirm,onClose:()=>y(null),type:p.type})]})}export{he as default};
