import{r as l,j as e,a0 as nr}from"./vendor-C23Namvk.js";import{a as D}from"./vendor-utils-C44aPrMG.js";import{c as x,b as lr,d as v,a as or,P as Xe,f as yt,L as cr}from"./index-DXxzNUOO.js";import{D as kt}from"./settings-DRiS_Ul1.js";import{P as wt}from"./PrintTemplate-LOkWw4wH.js";import{T as dr}from"./Toast-rpGoMLC9.js";import{P as vt}from"./ProductEditModal-BVhwk0Ym.js";import{P as jt}from"./PartnerEditModal-CErylDqj.js";import{A as O,m}from"./vendor-framer-DVZK1f_z.js";import{a as Lt,X as we,l as et,t as Nt,b as pr,I as tt,W as Ye,c as ye,J as _t,K as Ct,N as xr,O as Ze,Q as ke,V as St,Y as De,_ as qt,L as It,$ as ur,A as Pe,a0 as Tt,k as mr,m as zt,a1 as Dt,a2 as Pt,d as hr,a3 as fr}from"./vendor-icons-C8Df64wb.js";function br({partner:N,isOpen:ce,onClose:A,onAddToCart:Le}){const[q,W]=l.useState([]),[p,C]=l.useState([]),[d,_]=l.useState(!1),[R,T]=l.useState("invoices");l.useEffect(()=>{ce&&N&&de()},[ce,N]);const de=async()=>{_(!0);try{const u=await D.get(`/api/orders?partner_id=${N.id}&limit=10&type=Sale`),y=u.data.items||u.data;W(y);const h={};y.forEach(k=>{k.details.forEach(b=>{h[b.product_id]||(h[b.product_id]={id:b.product_id,name:b.product_name,unit:b.product_unit,price:b.price,total_qty:0,last_price:b.price,last_date:k.date,multiplier:b.multiplier,secondary_unit:b.secondary_unit,stock:b.stock}),h[b.product_id].total_qty+=b.quantity,new Date(k.date)>new Date(h[b.product_id].last_date)&&(h[b.product_id].last_date=k.date,h[b.product_id].last_price=b.price)})}),C(Object.values(h).sort((k,b)=>b.total_qty-k.total_qty))}catch(u){console.error("Error fetching POS history:",u)}finally{_(!1)}},[P,$]=l.useState({}),V=u=>{$(y=>({...y,[u]:!y[u]}))};return e.jsx(O,{children:ce&&e.jsxs("div",{className:"fixed inset-0 z-[5000] flex justify-end",children:[e.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:A,className:"absolute inset-0 bg-black/20 backdrop-blur-[2px]"}),e.jsxs(m.div,{initial:{x:"100%",opacity:0},animate:{x:0,opacity:1},exit:{x:"100%",opacity:0},transition:{type:"spring",damping:25,stiffness:200},className:"relative w-[400px] h-full bg-white dark:bg-slate-900 shadow-2xl flex flex-col border-l border-primary/20",children:[e.jsxs("div",{className:"p-6 border-b dark:border-slate-800 bg-gradient-to-r from-primary/5 to-transparent flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-xl text-primary",children:e.jsx(Lt,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-lg text-gray-800 dark:text-gray-100 uppercase tracking-tighter leading-none",children:"L·ªãch s·ª≠ kh√°ch h√†ng"}),e.jsx("p",{className:"text-[10px] font-bold text-primary/60 uppercase tracking-widest mt-1",children:N.name})]})]}),e.jsx("button",{onClick:A,className:"p-2 hover:bg-rose-50 dark:hover:bg-rose-900/20 text-gray-400 hover:text-rose-500 rounded-xl transition-all",children:e.jsx(we,{size:20})})]}),e.jsxs("div",{className:"flex p-4 gap-2",children:[e.jsxs("button",{onClick:()=>T("invoices"),className:x("flex-1 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all flex items-center justify-center gap-2",R==="invoices"?"bg-primary text-white shadow-lg shadow-primary/20":"bg-gray-100 dark:bg-slate-800 text-gray-500 hover:bg-gray-200 dark:hover:bg-slate-700"),children:[e.jsx(et,{size:16})," H√≥a ƒë∆°n"]}),e.jsxs("button",{onClick:()=>T("products"),className:x("flex-1 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all flex items-center justify-center gap-2",R==="products"?"bg-primary text-white shadow-lg shadow-primary/20":"bg-gray-100 dark:bg-slate-800 text-gray-500 hover:bg-gray-200 dark:hover:bg-slate-700"),children:[e.jsx(Nt,{size:16})," S·∫£n ph·∫©m"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar p-4 space-y-3",children:d?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 opacity-30",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin mb-4"}),e.jsx("span",{className:"font-black text-[10px] uppercase tracking-[0.2em]",children:"ƒêang t·∫£i..."})]}):R==="invoices"?q.length===0?e.jsxs("div",{className:"text-center py-20 text-gray-300 dark:text-slate-700",children:[e.jsx(et,{size:48,className:"mx-auto mb-4 opacity-20"}),e.jsx("p",{className:"font-black uppercase text-xs tracking-widest",children:"Ch∆∞a c√≥ h√≥a ƒë∆°n n√†o"})]}):q.map((u,y)=>{const h=P[u.id],k=h?u.details:u.details.slice(0,3);return e.jsxs(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:y*.05},className:"bg-gray-50 dark:bg-slate-800/50 p-4 rounded-2xl border border-transparent hover:border-primary/20 transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs font-black text-primary uppercase",children:["#",u.display_id||u.id]}),e.jsxs("div",{className:"text-[10px] font-bold text-gray-400 flex items-center gap-1 mt-0.5",children:[e.jsx(pr,{size:10})," ",lr(u.date)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-black text-gray-800 dark:text-gray-100",children:v(u.total_amount)}),e.jsx("div",{className:x("text-[9px] font-black uppercase px-1.5 py-0.5 rounded ml-auto w-fit mt-1",u.payment_method==="Debt"?"bg-rose-100 text-rose-600":"bg-emerald-100 text-emerald-600"),children:u.payment_method==="Debt"?"N·ª£":"Ti·ªÅn m·∫∑t"})]})]}),e.jsxs("div",{className:"space-y-1 bg-white/50 dark:bg-slate-900/50 p-2 rounded-xl",children:[k.map((b,re)=>e.jsxs("div",{className:"text-[10px] flex justify-between text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{className:"truncate flex-1 pr-2 uppercase font-bold",children:["‚Ä¢ ",b.product_name]}),e.jsxs("span",{className:"font-black",children:["x",v(b.quantity)]})]},re)),u.details.length>3&&e.jsx("button",{onClick:()=>V(u.id),className:"text-[9px] text-primary font-bold italic w-full text-left pt-1",children:h?"Thu g·ªçn":`... v√† ${u.details.length-3} s·∫£n ph·∫©m kh√°c`})]})]},u.id)}):p.length===0?e.jsxs("div",{className:"text-center py-20 text-gray-300 dark:text-slate-700",children:[e.jsx(Nt,{size:48,className:"mx-auto mb-4 opacity-20"}),e.jsx("p",{className:"font-black uppercase text-xs tracking-widest",children:"Ch∆∞a mua s·∫£n ph·∫©m n√†o"})]}):p.map((u,y)=>e.jsxs(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:y*.05},className:"bg-gray-50 dark:bg-slate-800/50 p-4 rounded-2xl border border-transparent hover:border-primary/20 transition-all group flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[e.jsx("div",{className:"font-black text-xs text-gray-800 dark:text-gray-100 uppercase truncate",title:u.name,children:u.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:"text-[10px] font-black text-primary tabular-nums",children:["ƒê√£ mua: ",v(u.total_qty)," ",u.unit]}),e.jsx("span",{className:"w-1 h-1 rounded-full bg-gray-300"}),e.jsxs("span",{className:"text-[10px] font-bold text-gray-400",children:["Gi√° g·∫ßn nh·∫•t: ",v(u.last_price)]})]})]}),e.jsx("button",{onClick:()=>Le(u),className:"w-10 h-10 bg-white dark:bg-slate-700 text-primary hover:bg-primary hover:text-white rounded-xl shadow-sm flex items-center justify-center transition-all active:scale-90",title:"Th√™m v√†o gi·ªè",children:e.jsx(tt,{size:20})})]},u.id))}),e.jsx("div",{className:"p-6 bg-gray-50 dark:bg-slate-800/50 border-t dark:border-slate-800",children:e.jsxs("div",{className:"bg-primary/5 rounded-2xl p-4 border border-primary/10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"T·ªïng d·ª± n·ª£ hi·ªán t·∫°i"}),e.jsx("span",{className:"p-1 px-2 bg-rose-100 text-rose-600 rounded text-[9px] font-black uppercase",children:"ƒêang n·ª£"})]}),e.jsxs("div",{className:"text-2xl font-black text-rose-500 tracking-tighter tabular-nums",children:[v(N.debt_balance)," ",e.jsx("span",{className:"text-xs",children:"VNƒê"})]})]})})]})]})})}function qr(){const[N,ce]=l.useState([]),[A,Le]=l.useState([]),[q,W]=l.useState(""),[p,C]=l.useState([]),[d,_]=l.useState(null),[R,T]=l.useState(""),[de,P]=l.useState(!1),[$,V]=l.useState(""),[u,y]=l.useState(0),[h,k]=l.useState(()=>(localStorage.getItem("unified_pos_mode")||"Retail")==="Wholesale"?"Pending":"Cash"),[b,re]=l.useState(null),[F,rt]=l.useState(!1),[S,pe]=l.useState(null),[ae,ve]=l.useState(null),[Ee,at]=l.useState(null),[B,Oe]=l.useState(0),G=nr(),[H,Ae]=l.useState(()=>{const t=localStorage.getItem("held_invoices");return t?JSON.parse(t):[]}),[We,X]=l.useState(!1),[xe,st]=l.useState(!1),[g,se]=l.useState(0),[w,Re]=l.useState({}),[Et,Ot]=l.useState([]),[it,nt]=l.useState(""),[K,At]=l.useState(kt),[je,Ne]=l.useState(!1),[_e,Ce]=l.useState(!1),[lt,ot]=l.useState(""),[He,ie]=l.useState(null),[L,Wt]=l.useState(()=>localStorage.getItem("unified_pos_mode")||"Retail"),[n,M]=l.useState({product:null,quantity:1,price:0,secondary_qty:0,name:""}),[Y,J]=l.useState(null),[ne,ct]=l.useState(""),[le,Se]=l.useState(0),[Me,ue]=l.useState(!1),[dt,Rt]=l.useState(null),[$e,oe]=l.useState(!1),[Ht,qe]=l.useState(null),Mt=l.useRef({}),U=l.useRef(null),Z=l.useRef(null),Fe=l.useRef(null),Be=l.useRef(null);l.useEffect(()=>{const t=r=>{r.key==="F3"&&(r.preventDefault(),Be.current?.focus(),Be.current?.select())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[]);const Ie=l.useRef(null),Ke=l.useRef(null),Ue=l.useRef(null),me=l.useRef(null),[$t,Qe]=l.useState(!1),[Ft,pt]=l.useState(null),[xt,Bt]=l.useState(!1),[ut,Kt]=l.useState(new Date),[Ut,mt]=l.useState(!1),[Qt,Ve]=l.useState(!1);l.useEffect(()=>{const t=setInterval(()=>Kt(new Date),1e3);return()=>clearInterval(t)},[]);const ht=l.useMemo(()=>n.product?n.price*n.quantity:0,[n.product,n.price,n.quantity]),z=l.useMemo(()=>p.reduce((t,r)=>t+r.price*r.quantity,0)+ht,[p,ht]),Vt=l.useMemo(()=>p.length+(n.product?1:0),[p,n.product]),Jt=l.useMemo(()=>p.reduce((t,r)=>t+(r.quantity||0),0)+(n.quantity||0),[p,n.quantity]),Gt=l.useMemo(()=>p.reduce((t,r)=>t+(r.secondary_qty||0),0)+(n.secondary_qty||0),[p,n.secondary_qty]),Te=l.useMemo(()=>{if(!d)return 0;let t=d.debt_balance;if(S&&ae&&d.id===ae.partner_id&&ae.payment_method==="Debt"){const r=(ae.total_amount||0)-(ae.amount_paid||0);t-=r}return t},[d,S,ae]),Xt=h==="Debt"?Te+(z>=0?z-u:z+u):Te;l.useEffect(()=>{localStorage.setItem("held_invoices",JSON.stringify(H))},[H]),l.useEffect(()=>{const t=r=>{const a=r.key.toUpperCase();r.key==="Escape"?(de||We||Me||je||_e||$e||q||Y!==null)&&(P(!1),X(!1),ue(!1),Ne(!1),Ce(!1),oe(!1),W(""),J(null),Ve(!1)):a===(K.kb_search||"F2").toUpperCase()?(r.preventDefault(),U.current?.focus()):a===(K.kb_save||"F12").toUpperCase()?(r.preventDefault(),ee(!1)):a===(K.kb_pay||"F9").toUpperCase()?(r.preventDefault(),ee(!0)):a===(K.kb_new||"F4").toUpperCase()?(r.preventDefault(),Q()):a===(K.kb_hold||"F8").toUpperCase()&&(r.preventDefault(),Ge())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[p,d,u,$,K,de,We,Me,je,_e,$e,q,Y]),l.useEffect(()=>{},[]);const Je=()=>{const t=localStorage.getItem("pos_draft");if(t)try{const r=JSON.parse(t);if(C(r.cart||[]),V(r.note||""),y(r.amountPaid||0),k(r.paymentMethod||(localStorage.getItem("unified_pos_mode")==="Wholesale"?"Pending":"Cash")),r.selectedPartnerId){const a=A.find(i=>i.id===r.selectedPartnerId);_(a||null)}else _(null);return pe(null),ve(null),Oe(0),!0}catch(r){console.error("Error loading draft",r)}return!1};l.useEffect(()=>{if(he(),fe(),er(),tr(),G.state?.editOrder||Je(),G.state?.editOrder){const t=G.state.editOrder;ft(t)}else{const r=new URLSearchParams(window.location.search).get("edit");r?Yt(r):S&&Q(!1)}Bt(!0)},[G.search,G.state]);const Yt=async t=>{try{const r=await D.get(`/api/orders/${t}`);r.data&&ft(r.data)}catch(r){console.error("Error fetching order",r),ie({message:"Kh√¥ng t√¨m th·∫•y h√≥a ƒë∆°n",type:"error"})}},ft=t=>{pe(t.id),ve(t),C(t.details.map(r=>({product_id:r.product_id,product_name:r.product_name,unit:r.product_unit,secondary_unit:r.secondary_unit,multiplier:r.multiplier||1,price:r.price,cost_price:r.cost_price,quantity:r.quantity,secondary_qty:r.quantity/(r.multiplier||1),stock:r.stock||0,active_ingredient:r.active_ingredient}))),V(t.note||""),y(t.amount_paid||0),k(t.payment_method),at(t.partner_id),T(""),W(""),P(!1)},Zt=t=>{Wt(t),localStorage.setItem("unified_pos_mode",t),p.length===0&&!S&&k(t==="Wholesale"?"Pending":"Cash")};l.useEffect(()=>{h==="Cash"&&y(z)},[h,z]),l.useEffect(()=>{if(xt&&!S){const t={cart:p,selectedPartnerId:d?.id,note:$,amountPaid:u,paymentMethod:h};localStorage.setItem("pos_draft",JSON.stringify(t))}},[p,d,$,u,h,S,xt]),l.useEffect(()=>{if(A.length>0){if(Ee){const t=A.find(r=>r.id==Ee);t&&(_(t),at(null),T(""))}else if(!S){const t=localStorage.getItem("pos_draft");if(t)try{const r=JSON.parse(t);if(r.selectedPartnerId){const a=A.find(i=>i.id===r.selectedPartnerId);a&&(_(a),T(""))}}catch{}}}},[A,Ee,S,G.state]);const er=async()=>{try{const[t,r]=await Promise.all([D.get("/api/print-templates?module=Sale"),D.get("/api/settings")]);let a={...kt};if(r.data&&(a={...a,...r.data}),t.data&&t.data.length>0){const s=t.data.find(o=>o.is_default)||t.data[0];if(s)try{const o=JSON.parse(s.config);a={...a,...o}}catch(o){console.error("Error parsing template config",o)}}At(a);const i=S||G.state?.editOrder||new URLSearchParams(window.location.search).get("edit");p.length===0&&!i&&(k(L==="Wholesale"?"Pending":"Cash"),y(z))}catch(t){console.error("L·ªói khi t·∫£i c√†i ƒë·∫∑t:",t)}},he=async()=>{try{const t=await D.get("/api/products");ce(t.data)}catch(t){console.error(t)}},fe=async()=>{try{const t=await D.get("/api/partners");Le(t.data)}catch(t){console.error(t)}},tr=async()=>{try{const t=await D.get("/api/bank-accounts");Ot(t.data),t.data.length>0&&nt(t.data[0].id)}catch(t){console.error(t)}},rr=async t=>{if(!t){Re({});return}try{const r=await D.get(`/api/custom-prices/${t}`);Re(r.data)}catch(r){console.error(r)}};l.useEffect(()=>{d?rr(d.id):Re({})},[d]),l.useEffect(()=>{p.length>0&&C(t=>t.map(r=>{const a=w[r.product_id];if(a!==void 0)return{...r,price:a};const i=N.find(s=>s.id===r.product_id);return{...r,price:i?i.sale_price:r.price}}))},[w]),l.useEffect(()=>{h==="Cash"&&y(z)},[z,h]);const be=(t,r=null,a=null)=>{const i=r!==null?r:1,s=p.find(f=>f.product_id===t.id),o=t.sale_price,c=a!==null?a:w[t.id]!==void 0?w[t.id]:o;C(s?p.map(f=>f.product_id===t.id?{...f,quantity:f.quantity+i,price:c,secondary_qty:(f.quantity+i)/(f.multiplier||1)}:f):[{product_id:t.id,product_name:t.name,unit:t.unit,secondary_unit:t.secondary_unit,multiplier:t.multiplier||1,price:c,cost_price:t.cost_price,quantity:i,secondary_qty:i/(t.multiplier||1),stock:t.stock,is_combo:t.is_combo,active_ingredient:t.active_ingredient},...p]),W(""),se(0),M({product:null,quantity:1,price:0,secondary_qty:0,name:""}),setTimeout(()=>{const f=U.current;f&&(f.focus(),f.select())},10)},ze=(t,r,a)=>{const i=[...p],s=i[t];r==="secondary_qty"?(s.secondary_qty=a,s.quantity=a*s.multiplier):r==="quantity"?(s.quantity=a,s.secondary_qty=a/s.multiplier):s[r]=a,C(i)},ar=t=>{C(p.filter((r,a)=>a!==t))},ee=async(t=!0)=>{let r=[...p];if(n.product&&n.quantity!==0){const a=r.findIndex(i=>i.product_id===n.product.id&&i.price===n.price);a>-1?(r[a].quantity+=n.quantity,r[a].secondary_qty+=n.secondary_qty):r=[{product_id:n.product.id,product_name:n.product.name,unit:n.product.unit,secondary_unit:n.product.secondary_unit,multiplier:n.product.multiplier||1,price:n.price,cost_price:n.product.cost_price,quantity:n.quantity,secondary_qty:n.secondary_qty,is_combo:n.product.is_combo},...r]}if(r.length!==0){rt(!0);try{const a={partner_id:d?d.id:null,type:"Sale",payment_method:h,details:r.map(s=>({product_id:s.product_id,product_name:s.product_name,quantity:s.quantity,price:s.price})),note:$,amount_paid:u,bank_account_id:h==="Transfer"?it:null};let i;if(S?i=await D.put(`/api/orders/${S}`,a):i=await D.post("/api/orders",a),re(i.data),d)for(const s of p){const o=w[s.product_id];s.price!==o&&await D.post("/api/custom-prices",{partner_id:d.id,product_id:s.product_id,price:s.price})}t?setTimeout(()=>{window.print(),setTimeout(()=>{Q(!1),he(),fe(),re(null)},1e3)},1e3):(Q(!1),he(),fe(),ie({message:"ƒê√£ l∆∞u ƒë∆°n h√†ng th√†nh c√¥ng!",type:"success"}),re(null),localStorage.removeItem("pos_draft"))}catch(a){ie({message:a.response?.data?.error||"L·ªói khi l∆∞u ƒë∆°n h√†ng",type:"error"})}finally{rt(!1)}}},Ge=()=>{if(p.length===0)return;const t={id:Date.now(),cart:[...p],partner:d,note:$,amountPaid:u,paymentMethod:h,total:z,time:new Date().toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}),editOrderId:S};Ae([...H,t]),localStorage.removeItem("pos_draft"),Q(),X(!0)},sr=t=>{C(t.cart),_(t.partner),V(t.note),y(t.amountPaid),k(t.paymentMethod||"Debt"),pe(t.editOrderId||null),Ae(H.filter(r=>r.id!==t.id)),X(!1)},ir=t=>{Ae(H.filter(r=>r.id!==t))},Q=(t=!1)=>{C([]),t||(_(null),T("")),W(""),P(!1),y(0),V("");const r=L==="Wholesale"?"Pending":"Cash";k(r),r==="Cash"&&y(0),pe(null),ve(null),re(null),Oe(0),setTimeout(()=>U.current?.focus(),100)},bt=async t=>{let r;if(t==="prev"?r=B+1:r=Math.max(0,B-1),r===0){Je()||Q();return}try{mt(!0);const a=await D.get(`/api/orders?type=Sale&limit=1&page=${r}`),i=a.data.items||a.data;if(i&&i.length>0){const s=i[0];await new Promise(c=>setTimeout(c,150)),pe(s.id),ve(s),C(s.details.map(c=>({product_id:c.product_id,product_name:c.product_name,unit:c.product_unit,secondary_unit:c.secondary_unit,multiplier:c.multiplier||1,price:c.price,cost_price:c.cost_price||0,quantity:c.quantity,secondary_qty:c.quantity/(c.multiplier||1),is_combo:c.is_combo,active_ingredient:c.active_ingredient}))),V(s.note||""),y(s.amount_paid||0),k(s.payment_method);const o=A.find(c=>c.id===s.partner_id);_(o||null),Oe(r)}else t==="prev"?ie({message:"Kh√¥ng c√≤n ƒë∆°n h√†ng c≈© h∆°n.",type:"error"}):Q()}catch(a){console.error(a),ie({message:"L·ªói khi t·∫£i l·ªãch s·ª≠ ƒë∆°n h√†ng",type:"error"})}finally{setTimeout(()=>mt(!1),300)}},te=l.useMemo(()=>{const t=q.toLowerCase();return t?N.filter(r=>(r.name||"").toLowerCase().includes(t)||(r.code||"").toLowerCase().includes(t)||(r.active_ingredient||"").toLowerCase().includes(t)).sort((r,a)=>{const i=(r.name||"").toLowerCase(),s=(a.name||"").toLowerCase(),o=i.startsWith(t),c=s.startsWith(t);return o&&!c?-1:!o&&c?1:r.code?.toLowerCase()===t&&a.code?.toLowerCase()!==t?-1:r.code?.toLowerCase()!==t&&a.code?.toLowerCase()===t?1:i.localeCompare(s,"vi",{sensitivity:"base"})}).slice(0,10):N.slice(0,10)},[N,q]),ge=l.useMemo(()=>{const t=R.toLowerCase();return A.filter(r=>(r.name||"").toLowerCase().includes(t)||(r.phone||"").includes(t)).sort((r,a)=>{const i=(r.name||"").toLowerCase(),s=(a.name||"").toLowerCase(),o=i.startsWith(t),c=s.startsWith(t);return o&&!c?-1:!o&&c?1:i.localeCompare(s,"vi",{sensitivity:"base"})})},[A,R]);return e.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden no-print",children:[e.jsxs("div",{className:"p-4 flex gap-6 items-center print:hidden transition-colors relative border-primary/20 z-[110]",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute right-[-40px] top-[-40px] opacity-[0.03] dark:opacity-[0.06] -rotate-12 transition-all duration-1000",children:e.jsx(Ye,{size:240,className:"text-primary"})}),e.jsx("div",{className:"absolute left-[-20px] bottom-[-20px] opacity-[0.02] dark:opacity-[0.04] rotate-45 transition-all duration-1000",children:e.jsx(ye,{size:180,className:"text-[#4a7c59]"})})]}),e.jsxs("div",{className:"flex items-center gap-3 mr-4 relative z-10",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-primary to-emerald-600 rounded-2xl shadow-lg",children:e.jsx(Ye,{size:28,className:"text-white",strokeWidth:2.5})}),e.jsxs("h1",{className:"text-2xl font-black text-primary dark:text-[#d4a574] uppercase tracking-tighter flex items-center gap-2",children:["V·ª• m√πa s·ªë",e.jsxs("span",{className:"text-sm font-bold px-3 py-1 bg-gradient-to-r from-[#d4a574]/20 to-[#f4c430]/20 text-muted dark:text-[#d4a574] rounded-xl border border-primary/30",children:["#",S||"M·ªöI"]})]}),e.jsxs("button",{onClick:()=>{const t={display_id:S?`ƒê∆°n #${S}`:"XEM TR∆Ø·ªöC",date:new Date().toISOString(),partner_name:d?d.name:"Kh√°ch L·∫ª",partner_address:d?d.address:"",partner_phone:d?d.phone:"",total_amount:z,amount_paid:u,payment_method:h,note:$,old_debt:Te,partner_id:d?d.id:null,details:p.map(r=>({...r}))};Rt(t),ue(!0)},className:"flex items-center gap-2 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm text-muted hover:text-primary hover:bg-[#d4a574]/20 dark:hover:bg-[#4a7c59]/20 px-4 py-2 rounded-xl border-2 border-[#d4a574]/30 transition-all font-black text-[10px] uppercase tracking-widest shadow-sm hover:shadow-md",children:[e.jsx(_t,{size:16})," Xem tr∆∞·ªõc in"]})]}),e.jsxs("div",{className:"flex-1 flex gap-4 relative z-10",children:[e.jsxs("div",{className:"w-80 relative z-50",onBlur:()=>setTimeout(()=>P(!1),200),children:[e.jsxs("div",{className:"relative cursor-pointer",onDoubleClick:t=>{t.preventDefault(),d&&(pt(d),Qe(!0))},children:[e.jsx(ye,{className:"absolute left-3 top-3 text-primary",size:18,strokeWidth:2.5}),e.jsx("input",{type:"text",className:"w-full pl-10 p-2.5 border-2 border-primary/30 dark:border-slate-800 rounded-xl focus:border-primary dark:focus:border-primary outline-none font-bold text-primary dark:text-gray-200 bg-white/90 dark:bg-slate-950/90 backdrop-blur-sm cursor-pointer transition-all shadow-sm focus:shadow-md",ref:Be,placeholder:"üîç T√¨m ki·∫øm ƒë·ªëi t√°c...",value:d?d.name:R,onDoubleClick:t=>{d&&(t.stopPropagation(),pt(d),Qe(!0))},onChange:t=>{T(t.target.value),d&&_(null),P(!0)},onKeyDown:t=>{if(t.key==="ArrowDown")t.preventDefault(),se(r=>{const a=Math.min(r+1,ge.length),i=Ke.current;if(i){const s=i.children[a];s&&s.scrollIntoView({block:"nearest"})}return a});else if(t.key==="ArrowUp")t.preventDefault(),se(r=>{const a=Math.max(r-1,0),i=Ke.current;if(i){const s=i.children[a];s&&s.scrollIntoView({block:"nearest"})}return a});else if(t.key==="Enter"){if(t.preventDefault(),g===0)_(null),T(""),P(!1);else if(ge[g-1]){const r=ge[g-1];_(r),T(""),P(!1)}}}}),d&&e.jsx("button",{onClick:()=>{_(null),T("")},className:"absolute right-3 top-3 text-muted hover:text-red-500 transition-colors",children:e.jsx(we,{size:16})})]}),e.jsx(O,{children:de&&!d&&e.jsxs(m.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{type:"spring",stiffness:400,damping:30},className:"dropdown-premium min-w-[320px] !z-[200]",ref:Ke,children:[e.jsxs("div",{className:x("dropdown-item flex items-center gap-3",g===0&&"active"),onClick:()=>{_(null),T(""),P(!1)},children:[e.jsx("div",{className:x("w-8 h-8 rounded-full flex items-center justify-center transition-colors",g===0?"bg-white/20 text-white":"bg-gray-100 dark:bg-slate-800 text-gray-500"),children:e.jsx(Ct,{size:16})}),e.jsxs("div",{children:[e.jsx("div",{className:x("font-black uppercase tracking-tight",g===0?"text-white":"text-gray-800 dark:text-gray-100"),children:"Kh√°ch l·∫ª"}),e.jsx("div",{className:x("text-[10px] font-bold",g===0?"text-white/70":"text-gray-400"),children:"Thanh to√°n ngay"})]})]}),e.jsx("div",{className:"max-h-[350px] overflow-y-auto no-scrollbar scroll-smooth",children:ge.map((t,r)=>e.jsxs("div",{onClick:()=>{_(t),T(""),P(!1)},className:x("dropdown-item flex justify-between items-center",g===r+1&&"active"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:x("w-8 h-8 rounded-full flex items-center justify-center transition-colors",g===r+1?"bg-white/20 text-white":"bg-primary/10 text-primary"),children:e.jsx(Ct,{size:16})}),e.jsxs("div",{children:[e.jsx("div",{className:x("font-black uppercase tracking-tight",g===r+1?"text-white":"text-gray-800 dark:text-gray-100"),children:t.name}),e.jsxs("div",{className:x("text-[10px] font-bold flex items-center gap-2",g===r+1?"text-white/70":"text-gray-400"),children:[e.jsxs("span",{className:"flex items-center gap-0.5",children:[e.jsx(xr,{size:10,strokeWidth:3})," ",t.phone||"N/A"]}),e.jsx("span",{className:"w-1 h-1 rounded-full bg-current opacity-30"}),e.jsx("span",{className:"flex items-center gap-0.5 uppercase tracking-tighter",children:t.is_customer&&t.is_supplier?"KH & NCC":t.is_customer?"Kh√°ch h√†ng":"Nh√† CC"})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:x("text-[10px] font-black uppercase opacity-60 mb-0.5",g===r+1?"text-white/60":"text-gray-400"),children:"D∆∞ n·ª£"}),e.jsx("div",{className:x("font-black text-sm",g===r+1?"text-white":"text-red-500"),children:or(t.debt_balance)})]})]},t.id))}),R&&ge.length===0&&e.jsxs("div",{className:"p-4 bg-primary text-white cursor-pointer font-black uppercase text-xs flex items-center gap-2 hover:brightness-110 transition-all",onClick:()=>{ot(R),Ne(!0),P(!1)},children:[e.jsx(Ze,{size:18,strokeWidth:3}),' Th√™m kh√°ch h√†ng m·ªõi: "',R,'"']})]})})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs(m.button,{whileTap:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},onClick:()=>X(!0),className:"relative p-2.5 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm text-muted dark:text-gray-400 rounded-xl hover:bg-[#d4a574]/20 dark:hover:bg-slate-700 transition-all font-bold flex items-center gap-2 border-2 border-[#d4a574]/20 shadow-sm hover:shadow-md",title:"H√≥a ƒë∆°n ch·ªù",children:[e.jsx(ke,{size:20}),H.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-gradient-to-br from-[#f4c430] to-[#d4a574] text-white text-[10px] w-5 h-5 rounded-full flex items-center justify-center font-black shadow-lg",children:H.length}),e.jsx("span",{className:"hidden lg:inline text-xs uppercase",children:"Hƒê Ch·ªù"})]}),e.jsxs("div",{className:"flex bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm rounded-xl overflow-hidden shadow-sm border-2 border-[#d4a574]/20",children:[e.jsx(m.button,{whileTap:{scale:.9},onClick:()=>bt("prev"),className:"p-2.5 text-muted dark:text-gray-400 hover:bg-[#d4a574]/20 dark:hover:bg-slate-700 transition-all border-r border-[#d4a574]/20 dark:border-slate-700",title:"ƒê∆°n tr∆∞·ªõc",children:e.jsx(St,{size:20})}),e.jsxs(m.button,{whileTap:{scale:.95},onClick:()=>{B!==0&&(Je()||Q())},className:"px-3 flex flex-col items-center justify-center min-w-[70px] hover:bg-[#d4a574]/20 dark:hover:bg-slate-700 transition-colors",title:"Quay v·ªÅ ƒë∆°n m·ªõi",children:[e.jsx("span",{className:x("text-[10px] font-black uppercase tracking-tighter",B===0?"text-primary dark:text-[#4a7c59]":"text-[#f4c430]"),children:B===0?"M·ªõi":`#${B}`}),B!==0&&e.jsx("span",{className:"text-[8px] font-bold text-muted dark:text-gray-400 uppercase leading-none",children:"V·ªÅ M·ªõi"})]}),e.jsx(m.button,{whileTap:{scale:.9},onClick:()=>bt("next"),disabled:B===0,className:x("p-2.5 text-muted dark:text-gray-400 hover:bg-[#d4a574]/20 dark:hover:bg-slate-700 transition-all border-l border-[#d4a574]/20 dark:border-slate-700",B===0&&"opacity-30 cursor-not-allowed"),title:"ƒê∆°n sau",children:e.jsx(tt,{size:20})})]}),e.jsxs(m.button,{whileTap:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},onClick:Q,className:"p-2.5 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm text-muted dark:text-gray-400 rounded-xl hover:bg-[#d4a574]/20 dark:hover:bg-slate-700 transition-all font-bold flex items-center gap-2 border-2 border-[#d4a574]/20 shadow-sm hover:shadow-md",title:"ƒê∆°n m·ªõi",children:[e.jsx(De,{size:20}),e.jsx("span",{className:"hidden lg:inline text-xs uppercase",children:"ƒê∆°n m·ªõi"})]}),e.jsxs(m.button,{whileTap:{scale:.95},onClick:()=>Zt(L==="Retail"?"Wholesale":"Retail"),className:x("px-4 py-2.5 rounded-xl font-black text-xs uppercase tracking-wider flex items-center gap-2 transition-all cursor-pointer select-none shadow-sm hover:shadow-md border-2",L==="Wholesale"?"bg-gradient-to-r from-[#f4c430]/20 to-[#d4a574]/20 text-muted border-[#d4a574]/30 hover:from-[#f4c430]/30 hover:to-[#d4a574]/30":"bg-gradient-to-r from-primary/20 to-primary-hover/20 text-primary dark:text-[#4a7c59] border-[#4a7c59]/30 hover:from-primary/30 hover:to-primary-hover/30"),children:[e.jsx("div",{className:x("w-2 h-2 rounded-full",L==="Wholesale"?"bg-amber-500":"bg-emerald-500")}),L==="Wholesale"?"S·ªà":"L·∫∫"]}),d&&e.jsx(m.button,{whileTap:{scale:.95},onClick:()=>Ve(!0),className:"p-2.5 bg-gradient-to-br from-primary to-emerald-600 text-white rounded-xl shadow-lg hover:shadow-primary/40 transition-all border-2 border-white/20 dark:border-slate-700/50 flex items-center justify-center",title:"L·ªãch s·ª≠ mua h√†ng",children:e.jsx(Lt,{size:20,strokeWidth:3})})]}),e.jsx("div",{className:"flex-1 flex justify-end items-center mr-2",children:e.jsxs("div",{className:"flex flex-col items-end opacity-80 hover:opacity-100 transition-opacity select-none",children:[e.jsx("div",{className:"text-2xl font-black text-primary dark:text-[#d4a574] tracking-tighter leading-none flex items-center gap-2 tabular-nums",children:ut.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})}),e.jsxs("div",{className:"text-[10px] font-bold text-muted dark:text-gray-400 uppercase tracking-widest flex items-center gap-1.5",children:[e.jsx(et,{size:10,strokeWidth:2.5}),e.jsx("span",{children:ut.toLocaleDateString("vi-VN",{weekday:"short",day:"2-digit",month:"2-digit",year:"numeric"})})]})]})})]})]}),e.jsx(O,{children:We&&e.jsx(Xe,{children:e.jsxs("div",{className:"fixed inset-0 z-[2000] flex justify-end font-sans",children:[e.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/40 backdrop-blur-[2px]",onClick:()=>X(!1)}),e.jsxs(m.div,{initial:{x:"100%",opacity:.5},animate:{x:0,opacity:1},exit:{x:"100%",opacity:.5},transition:{type:"spring",damping:30,stiffness:300,mass:.8},className:"relative w-[340px] md:w-[400px] bg-white dark:bg-slate-900 shadow-2xl h-full flex flex-col p-8 border-l border-white/10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-black text-gray-800 dark:text-gray-100 uppercase tracking-tighter flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-100 dark:bg-amber-900/30 rounded-xl",children:e.jsx(ke,{className:"text-amber-600 dark:text-amber-400",size:24})}),"H√≥a ƒë∆°n ch·ªù"]}),e.jsxs("p",{className:"text-[10px] font-black text-amber-600/60 uppercase tracking-[0.2em] mt-1 ml-1",children:["ƒêang treo (",H.length,")"]})]}),e.jsx("button",{onClick:()=>X(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-slate-800 rounded-full transition-all hover:rotate-90",children:e.jsx(we,{size:24,className:"text-gray-400"})})]}),e.jsx("div",{className:"flex-1 overflow-auto space-y-4 pr-2 no-scrollbar",children:H.length===0?e.jsxs("div",{className:"text-center py-32 text-gray-300 dark:text-slate-700",children:[e.jsxs("div",{className:"relative inline-block mb-4",children:[e.jsx(ke,{size:64,className:"opacity-20 mx-auto"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-white dark:from-slate-900 to-transparent"})]}),e.jsx("p",{className:"font-black uppercase text-xs tracking-widest",children:"Tr·ªëng tr·∫£i..."})]}):e.jsx(O,{mode:"popLayout",children:H.map((t,r)=>e.jsxs(m.div,{layout:!0,initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,scale:.9,x:20},transition:{delay:r*.05,type:"spring",stiffness:400,damping:30},className:"bg-white dark:bg-slate-800/40 border-2 border-amber-50 dark:border-amber-900/10 rounded-[2rem] p-5 hover:border-amber-200 dark:hover:border-amber-600/30 transition-all group shadow-sm hover:shadow-xl hover:-translate-y-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-black text-gray-800 dark:text-gray-100 uppercase text-sm leading-tight group-hover:text-amber-600 transition-colors",children:t.partner?t.partner.name:"KH√ÅCH B√ÅN L·∫∫"}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsxs("div",{className:"text-[10px] font-black text-gray-400 bg-gray-50 dark:bg-slate-900 px-2 py-0.5 rounded-full uppercase tabular-nums",children:["üïí ",t.time]}),e.jsxs("div",{className:"text-[10px] font-black text-amber-600/70 bg-amber-50 dark:bg-amber-900/20 px-2 py-0.5 rounded-full uppercase",children:[t.cart.length," m√≥n"]})]})]}),e.jsx("button",{onClick:()=>ir(t.id),className:"text-gray-300 hover:text-rose-500 transition-colors p-1.5 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg",children:e.jsx(qt,{size:18})})]}),e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 dark:bg-slate-900/50 p-3 rounded-2xl border border-dashed border-gray-200 dark:border-slate-700",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[9px] font-black text-gray-400 uppercase leading-none mb-1",children:"T·ªïng c·ªông"}),e.jsx("div",{className:"text-amber-600 dark:text-amber-400 font-black text-xl tracking-tighter",children:v(t.total)})]}),e.jsxs(m.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>sr(t),className:"bg-gradient-to-r from-amber-500 to-amber-600 text-white px-5 py-2 rounded-xl font-black text-[11px] uppercase flex items-center gap-2 shadow-lg shadow-amber-500/30 hover:shadow-amber-500/50 transition-all",children:[e.jsx(De,{size:14,strokeWidth:3}),"THU H·ªíI"]})]})]},t.id))})}),e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-100 dark:border-slate-800",children:e.jsx("button",{onClick:()=>X(!1),className:"w-full py-4 rounded-2xl border-2 border-gray-200 dark:border-slate-800 text-gray-500 font-black uppercase text-xs hover:bg-gray-50 dark:hover:bg-slate-800 transition-all tracking-widest",children:"ƒê√≥ng sidebar"})})]})]})})}),e.jsxs("div",{className:"flex-1 flex gap-3 p-4 pt-0 pb-4 print:hidden min-h-0",children:[e.jsx(m.div,{initial:!1,animate:{width:xe?"78%":"calc(100% - 90px)"},transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col min-h-0",children:e.jsx("div",{className:x("flex-1 overflow-hidden relative shadow-2xl transition-all duration-500 rounded-[2.7rem]",K.ui_show_rainbow_border==="true"&&"premium-rainbow-border"),children:e.jsxs("div",{className:"w-full h-full rounded-[2.5rem] overflow-hidden relative main-content-bg",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none",style:{backgroundImage:`repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(139, 111, 71, 0.1) 10px, rgba(139, 111, 71, 0.1) 20px),
                                            radial-gradient(circle at 3px 3px, rgba(45, 80, 22, 0.08) 1px, transparent 0)`,backgroundSize:"40px 40px, 30px 30px",backgroundPosition:"0 0, 15px 15px"}}),e.jsx("div",{className:"absolute inset-0 overflow-auto no-scrollbar-on-empty",children:e.jsxs("div",{className:"min-w-[1000px] transition-colors relative group/decoration pb-40",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden rounded-[2.5rem] pointer-events-none",children:[e.jsx("div",{className:"absolute right-[-100px] bottom-[-100px] opacity-[0.02] dark:opacity-[0.04] group-hover/decoration:scale-110 transition-transform duration-[2000ms] text-[#4a7c59]",children:e.jsx(It,{size:600})}),e.jsx("div",{className:"absolute left-[-50px] top-[-50px] opacity-[0.015] dark:opacity-[0.03] group-hover/decoration:rotate-12 transition-transform duration-[3000ms] text-muted",children:e.jsx(Ye,{size:400})})]}),e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsxs("thead",{className:"bg-gradient-to-r from-primary/10 via-primary-hover/8 to-primary/10 border-b-2 border-[#d4a574]/40 text-primary dark:text-[#d4a574] uppercase text-[11px] font-black tracking-wider transition-colors sticky top-0 z-[100] shadow-md backdrop-blur-sm",children:[e.jsxs("tr",{children:[e.jsx("th",{rowSpan:2,className:"p-2 w-16 text-center align-middle",children:"Stt"}),e.jsx("th",{className:"px-4 py-0 align-middle text-center min-w-[450px]",children:e.jsx("div",{className:"flex items-center justify-center gap-3 h-full min-h-[36px]",children:e.jsx("span",{className:"font-black uppercase tracking-wider",children:"T√™n S·∫£n Ph·∫©m"})})}),e.jsx("th",{rowSpan:2,className:"p-2 w-32 text-center align-middle",children:"ƒêVT"}),e.jsx("th",{className:"p-2 w-40 text-center whitespace-nowrap",children:"SL Quy ƒë·ªïi"}),e.jsx("th",{className:"p-2 w-24 text-center text-primary dark:text-[#d4a574] whitespace-nowrap",children:"S·ªë l∆∞·ª£ng"}),e.jsx("th",{rowSpan:2,className:"p-2 w-40 text-center align-middle",children:"ƒê∆°n gi√°"}),e.jsx("th",{rowSpan:2,className:"p-2 w-40 text-center align-middle",children:"Th√†nh ti·ªÅn"}),e.jsx("th",{rowSpan:2,className:"p-2 w-10 text-center align-middle"})]}),e.jsxs("tr",{className:"border-t border-[#d4a574]/20 text-[10px]",children:[e.jsxs("td",{className:"px-4 py-1 text-primary/60 dark:text-[#d4a574]/60 font-black uppercase tracking-[0.1em] text-center border-r border-[#d4a574]/10",children:["T·ªïng ƒë·ªëi so√°t (",Vt," m·∫∑t h√†ng)"]}),e.jsx("td",{className:"px-4 py-1 text-center border-r border-[#d4a574]/10",children:e.jsxs("div",{className:"flex items-center justify-center gap-1.5",children:[e.jsx("span",{className:"text-sm font-black text-primary dark:text-[#d4a574]",children:v(Gt)}),e.jsx("span",{className:"text-[8px] font-black text-primary/40 uppercase tracking-tighter",children:"Quy ƒë·ªïi"})]})}),e.jsx("td",{className:"px-4 py-1 text-center border-r border-[#d4a574]/10",children:e.jsxs("div",{className:"flex items-center justify-center gap-1.5",children:[e.jsx("span",{className:"text-sm font-black text-primary dark:text-[#d4a574]",children:v(Jt)}),e.jsx("span",{className:"text-[8px] font-black text-primary/40 uppercase tracking-tighter",children:"SL L·∫ª"})]})})]})]}),e.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-800",children:[e.jsxs("tr",{className:"bg-gradient-to-r from-[#faf8f3]/60 via-white/40 to-[#faf8f3]/60 dark:bg-slate-900/40 print:hidden border-b-2 border-[#d4a574]/30 sticky top-[62px] z-[90] backdrop-blur-md cursor-pointer shadow-sm",onDoubleClick:()=>{n.product&&(qe(n.product),oe(!0))},children:[e.jsx("td",{className:"p-4 text-center",children:e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center mx-auto",children:e.jsx(Ze,{className:"text-primary",size:18})})}),e.jsx("td",{className:"p-2 relative",children:e.jsxs("div",{className:"relative group/search",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 z-10 text-gray-400",children:e.jsx(ur,{size:20})}),e.jsx("input",{type:"text",placeholder:"T√™n s·∫£n ph·∫©m (F2)...",className:"w-full p-2.5 pl-12 pr-16 bg-white/80 dark:bg-slate-800 border-2 border-[#d4a574]/20 focus:border-primary dark:focus:border-[#4a7c59] focus:bg-white rounded-xl font-black text-gray-800 dark:text-gray-100 uppercase outline-none transition-all shadow-sm",autoComplete:"off",value:q,onChange:t=>{const r=t.target.value;W(r),se(0),n.product&&r!==n.name&&M({...n,product:null,name:r})},onKeyDown:t=>{if(t.key==="ArrowUp")t.preventDefault(),se(r=>{const a=Math.max(r-1,0),i=Ue.current;if(i){const s=i.children[a];s&&s.scrollIntoView({block:"nearest"})}return a});else if(t.key==="ArrowDown")t.preventDefault(),se(r=>{const a=Math.min(r+1,te.length-1),i=Ue.current;if(i){const s=i.children[a];s&&s.scrollIntoView({block:"nearest"})}return a});else if(t.key==="Enter"){if(t.preventDefault(),q&&te[g]){const r=te[g],a=n.quantity!==0?n.quantity:1;M({product:r,quantity:a,price:w[r.id]!==void 0?w[r.id]:r.sale_price,secondary_qty:a/(r.multiplier||1),name:r.name}),W(r.name),be(r,1,w[r.id]!==void 0?w[r.id]:r.sale_price)}}else if(t.key==="Tab"){if(n.product){t.preventDefault();const r=L==="Wholesale"&&n.product.secondary_unit?Ie:Z;setTimeout(()=>{r.current?.focus(),r.current?.select()},10)}else if(q&&te[g]){t.preventDefault();const r=te[g],a=n.quantity!==0?n.quantity:1;M({product:r,quantity:a,price:w[r.id]!==void 0?w[r.id]:r.sale_price,secondary_qty:a/(r.multiplier||1),name:r.name}),W(r.name);const i=L==="Wholesale"&&r.secondary_unit?Ie:Z;setTimeout(()=>{i.current?.focus(),i.current?.select()},10)}}},ref:U}),n.product&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-2 pointer-events-none",children:e.jsxs("div",{className:x("px-3 py-1 rounded-xl text-[13px] font-black shadow-sm border-2 transition-all flex items-center gap-1.5",n.product.stock<10?"bg-rose-50 text-rose-600 border-rose-200 dark:bg-rose-900/30 dark:text-rose-400 dark:border-rose-800/50":"bg-emerald-50 text-emerald-600 border-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-400 dark:border-emerald-800/50"),children:[e.jsx(Pe,{size:14,className:"opacity-70"}),n.product.stock]})}),e.jsx(O,{children:q&&!n.product&&e.jsxs(m.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{type:"spring",stiffness:400,damping:30},className:"dropdown-premium min-w-[500px] !z-[150]",children:[e.jsx("div",{className:"max-h-[400px] overflow-y-auto no-scrollbar scroll-smooth",ref:Ue,children:te.map((t,r)=>e.jsxs("div",{onClick:()=>{const a=n.quantity!==0?n.quantity:1;M({product:t,quantity:a,price:w[t.id]!==void 0?w[t.id]:t.sale_price,secondary_qty:a/(t.multiplier||1),name:t.name}),W(t.name),W(t.name);const i=L==="Wholesale"&&t.secondary_unit?Ie:Z;setTimeout(()=>{i.current?.focus(),i.current?.select()},10)},className:x("dropdown-item flex justify-between items-center",r===g&&"active"),children:[e.jsxs("div",{children:[e.jsx("div",{className:x("font-black uppercase tracking-tight",r===g?"text-white":"text-gray-800 dark:text-gray-100"),children:t.name}),e.jsx("div",{className:x("text-[10px] font-bold italic mb-0.5",r===g?"text-white/80":"text-primary dark:text-emerald-400"),children:t.active_ingredient}),e.jsx("div",{className:x("text-[10px] uppercase font-black flex items-center gap-2",r===g?"text-white/70":"text-gray-500"),children:t.is_combo?e.jsx("span",{className:"bg-primary text-white px-1.5 rounded text-[9px]",children:"COMBO"}):e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:"opacity-60",children:[t.unit," ",t.multiplier>1&&`/ ${t.secondary_unit} (x${t.multiplier})`]}),e.jsxs("div",{className:x("ml-auto px-3 py-1 rounded-xl text-[13px] font-black border-2 transition-all flex items-center gap-1.5 shadow-sm",r===g?"bg-white !text-emerald-700 border-white":t.stock<10?"bg-rose-50 text-rose-600 border-rose-100 dark:bg-rose-900/30 dark:text-rose-400 dark:border-rose-800":"bg-emerald-50 text-emerald-600 border-emerald-100 dark:bg-emerald-900/30 dark:text-emerald-400 dark:border-emerald-800"),children:[e.jsx(Pe,{size:14,className:"opacity-70"}),t.stock]})]})})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:x("font-black text-lg tracking-tighter",r===g?"text-white":"text-primary dark:text-emerald-400"),children:v(t.sale_price)})})]},t.id))}),q&&te.length===0&&e.jsxs("div",{className:"p-4 bg-emerald-50 dark:bg-emerald-900/20 hover:bg-primary hover:text-white cursor-pointer text-primary dark:text-emerald-400 font-black uppercase text-xs flex items-center gap-2",onClick:()=>{ot(q),Ce(!0)},children:[e.jsx(Ze,{size:16}),' Th√™m s·∫£n ph·∫©m m·ªõi: "',q,'"']})]})})]})}),e.jsxs("td",{className:"p-4 text-center",children:[e.jsx("div",{className:"font-bold text-gray-700 dark:text-gray-200 text-xs",children:n.product?.unit||"-"}),n.product?.secondary_unit&&e.jsxs("div",{className:"text-[10px] text-primary dark:text-[#d4a574] font-black uppercase tracking-tighter",children:["1 ",n.product.secondary_unit," = ",n.product.multiplier," ",n.product.unit]})]}),e.jsx("td",{className:"p-2 w-32",children:n.product?.secondary_unit?e.jsxs("div",{className:"flex items-center gap-1 h-9 px-2 bg-amber-50/50 dark:bg-amber-900/10 border-2 border-dashed border-[#d4a574]/40 rounded-xl focus-within:border-primary dark:focus-within:border-[#4a7c59] focus-within:ring-4 focus-within:ring-primary/10 shadow-sm transition-all text-primary dark:text-[#d4a574]",children:[e.jsx("input",{type:"number",className:"w-full min-w-0 bg-transparent text-center font-black text-base outline-none placeholder:text-gray-300",id:"working-sec-qty",ref:Ie,value:n.secondary_qty,autoComplete:"off",onFocus:t=>t.target.select(),onChange:t=>{const r=parseFloat(t.target.value)||0;M(a=>{const i=parseFloat(a.product?.multiplier)||1;return{...a,secondary_qty:r,quantity:r*i}})},onKeyDown:t=>{t.key==="Tab"?(t.preventDefault(),Z.current?.focus()):t.key==="Enter"&&(t.preventDefault(),n.product&&n.quantity!==0&&be(n.product,n.quantity,n.price))}}),e.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase pr-2",children:n.product.secondary_unit})]}):e.jsx("div",{className:"text-center text-gray-300 italic text-[10px] font-bold h-[38px] flex items-center justify-center",children:"N/A"})}),e.jsx("td",{className:"p-2 w-24 group/qty",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"number",className:"w-full h-9 text-center bg-white dark:bg-slate-800 border-2 border-[#d4a574]/20 rounded-xl focus:border-primary dark:focus:border-[#4a7c59] focus:ring-4 focus:ring-primary/10 outline-none font-black text-lg text-primary dark:text-[#d4a574] shadow-sm transition-all placeholder:text-gray-300",value:n.quantity,id:"working-main-qty",ref:Z,autoComplete:"off",onFocus:t=>t.target.select(),onChange:t=>{const r=parseFloat(t.target.value)||0;M(a=>{const i=parseFloat(a.product?.multiplier)||1;return{...a,quantity:r,secondary_qty:r/i}})},onKeyDown:t=>{t.key==="Tab"?(t.preventDefault(),Fe.current?.focus()):t.key==="Enter"&&(t.preventDefault(),n.product&&n.quantity!==0&&be(n.product,n.quantity,n.price))}}),e.jsx("button",{tabIndex:-1,className:"absolute -top-2 -right-2 w-5 h-5 flex items-center justify-center bg-[#8b6f47] text-white rounded-full shadow-md hover:bg-[#8b6f47]/90 active:scale-95 z-[70] transition-all hover:scale-110 border border-white dark:border-slate-800 opacity-0 group-hover/qty:opacity-100 duration-200",onClick:()=>{M(t=>({...t,quantity:t.quantity*-1,secondary_qty:t.secondary_qty*-1})),Z.current?.focus()},title:"ƒê·ªïi th√†nh Tr·∫£ H√†ng (√Çm)",children:e.jsx(De,{size:10,strokeWidth:3})})]})}),e.jsx("td",{className:"p-2 text-right",children:e.jsxs("div",{className:"relative group/price",children:[e.jsx("input",{type:"text",className:x("w-full p-2 text-right bg-transparent border-none focus:ring-2 rounded font-bold transition-all outline-none",n.product&&n.price<n.product.cost_price?"text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 focus:ring-red-200 dark:focus:ring-red-900":"text-primary dark:text-[#d4a574] focus:ring-primary/20 dark:focus:ring-[#4a7c59]/20"),value:v(n.price),id:"working-price",ref:Fe,autoComplete:"off",onFocus:t=>t.target.select(),onChange:t=>{const r=parseFloat(t.target.value.replace(/,/g,""))||0;M({...n,price:r})},onKeyDown:t=>{t.key==="Enter"?(t.preventDefault(),n.product&&n.quantity!==0&&be(n.product,n.quantity,n.price)):t.key==="Tab"&&!t.shiftKey&&(t.preventDefault(),U.current?.focus())}}),n.product&&n.price<n.product.cost_price&&e.jsxs("div",{className:"absolute top-full right-0 bg-red-600 text-white text-sm px-4 py-2 rounded-xl font-black whitespace-nowrap z-[1001] flex items-center gap-2 shadow-2xl animate-bounce pointer-events-none uppercase tracking-tighter border-2 border-white dark:border-red-900 shadow-red-500/50 mt-2",children:[e.jsx(Tt,{size:18,fill:"white",className:"text-red-600"}),"L·ªñ V·ªêN (G·ªêC: ",yt(n.product.cost_price),")"]})]})}),e.jsxs("td",{className:"p-4 text-right",children:[e.jsx("div",{className:x("font-black text-lg transition-colors",n.quantity<0?"text-red-600 dark:text-red-400":"text-primary dark:text-[#d4a574]"),children:v(n.price*n.quantity)}),n.quantity<0&&e.jsx("span",{className:"inline-block px-2 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded text-[9px] font-black uppercase tracking-widest border border-red-200 dark:border-red-800/50 mt-1",children:"H√†ng tr·∫£"})]}),e.jsx("td",{className:"p-2 text-center",children:n.product&&e.jsx("button",{onClick:()=>M({product:null,quantity:1,price:0,secondary_qty:0,name:""}),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-xl transition-all",title:"X√≥a d√≤ng",children:e.jsx(we,{size:20})})})]}),e.jsx(O,{initial:!1,mode:"wait",children:Ut?e.jsx(m.tr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"w-full",children:e.jsx("td",{colSpan:9,className:"h-[400px] text-center relative align-middle",children:e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-primary/20 blur-xl rounded-full"}),e.jsx(mr,{size:48,className:"animate-spin text-primary relative z-10"})]}),e.jsx("span",{className:"text-sm font-black text-muted dark:text-[#d4a574] uppercase tracking-widest",children:"ƒêang ƒë·ªìng b·ªô d·ªØ li·ªáu..."})]})})},"loading-skeleton"):p.map((t,r)=>e.jsxs(m.tr,{layout:!0,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:50,scale:.95,transition:{duration:.2,ease:"easeIn"}},transition:{duration:.3,type:"spring",stiffness:300,damping:25,delay:r*.02},className:x("transition-colors group cursor-pointer border-b border-dashed border-gray-100 dark:border-slate-800 last:border-0",r%2===0?"bg-white/30 hover:bg-[#d4a574]/10":"bg-[#faf8f3]/20 hover:bg-[#d4a574]/15"),onDoubleClick:()=>{const a=N.find(i=>i.id===t.product_id);a&&(qe(a),oe(!0))},children:[e.jsx("td",{className:"p-4 text-center text-gray-400 font-bold group-hover:text-primary dark:group-hover:text-[#d4a574] transition-colors",children:p.length-r}),e.jsx("td",{className:"p-2 relative",children:e.jsxs("div",{className:"relative group/search-row",onDoubleClick:a=>{a.preventDefault();const i=N.find(s=>s.id===t.product_id);i&&(qe(i),oe(!0))},children:[e.jsx("input",{className:"w-full p-2 pr-16 bg-transparent border-none focus:ring-2 focus:ring-primary/20 dark:focus:ring-[#4a7c59]/20 rounded font-bold text-gray-800 dark:text-gray-100 uppercase outline-none",autoComplete:"off",value:Y===r?ne:t.product_name,onFocus:a=>{J(r),ct(t.product_name),Se(0),a.target.select()},onChange:a=>{ct(a.target.value),Se(0)},onBlur:()=>{setTimeout(()=>{J(a=>a===r?null:a)},200)},onDoubleClick:()=>{const a=N.find(i=>i.id===t.product_id);a&&(qe(a),oe(!0))},onKeyDown:a=>{const i=N.filter(s=>{const o=ne.toLowerCase();return(s.name||"").toLowerCase().includes(o)||(s.code||"").toLowerCase().includes(o)||(s.active_ingredient||"").toLowerCase().includes(o)}).sort((s,o)=>{const c=ne.toLowerCase(),f=(s.name||"").toLowerCase(),j=(o.name||"").toLowerCase(),I=f.startsWith(c),E=j.startsWith(c);return I&&!E?-1:!I&&E?1:s.code?.toLowerCase()===c&&o.code?.toLowerCase()!==c?-1:s.code?.toLowerCase()!==c&&o.code?.toLowerCase()===c?1:f.localeCompare(j,"vi",{sensitivity:"base"})}).slice(0,10);if(a.key==="ArrowDown")if(Y===r&&i.length>0)a.preventDefault(),Se(s=>{const o=Math.min(s+1,i.length-1);if(me.current){const c=me.current.children[o];c&&c.scrollIntoView({block:"nearest"})}return o});else{a.preventDefault();const s=r+1;s<p.length&&document.getElementById(`row-name-${s}`)?.focus()}else if(a.key==="ArrowUp")if(Y===r&&i.length>0)a.preventDefault(),Se(s=>{const o=Math.max(s-1,0);if(me.current){const c=me.current.children[o];c&&c.scrollIntoView({block:"nearest"})}return o});else{a.preventDefault();const s=r-1;s>=0?document.getElementById(`row-name-${s}`)?.focus():U.current?.focus()}else if(a.key==="Enter"){if(a.preventDefault(),i[le]){const s=i[le];let o=[...p];const c=o[r].quantity,f=o.findIndex((j,I)=>I!==r&&j.product_id===s.id);f>-1?(o[f].quantity+=c,o[f].secondary_qty=o[f].quantity/(o[f].multiplier||1),o.splice(r,1)):o[r]={...o[r],product_id:s.id,product_name:s.name,unit:s.unit,secondary_unit:s.secondary_unit,multiplier:s.multiplier||1,price:w[s.id]!==void 0?w[s.id]:s.sale_price,cost_price:s.cost_price,stock:s.stock,is_combo:s.is_combo,secondary_qty:c/(s.multiplier||1),active_ingredient:s.active_ingredient},C(o),J(null)}U.current?.focus()}else if(a.key==="Tab"){a.preventDefault();const s=i.length>0?i:[];if(s[le]){const o=s[le];let c=[...p];const f=c[r].quantity,j=c.findIndex((I,E)=>E!==r&&I.product_id===o.id);j>-1?(c[j].quantity+=f,c[j].secondary_qty=c[j].quantity/(c[j].multiplier||1),c.splice(r,1),C(c),J(null),setTimeout(()=>{const I=j>r?j-1:j,E=document.getElementById(`qty-sec-${I}`);if(L==="Wholesale"&&E&&!E.disabled)E.focus(),E.select?.();else{const gt=document.getElementById(`qty-main-${I}`);gt?.focus(),gt?.select?.()}},200)):(c[r]={...c[r],product_id:o.id,product_name:o.name,unit:o.unit,secondary_unit:o.secondary_unit,multiplier:o.multiplier||1,price:w[o.id]!==void 0?w[o.id]:o.sale_price,cost_price:o.cost_price,stock:o.stock,is_combo:o.is_combo,secondary_qty:f/(o.multiplier||1),active_ingredient:o.active_ingredient},C(c),J(null),setTimeout(()=>{const I=document.getElementById(`qty-sec-${r}`);if(L==="Wholesale"&&I&&!I.disabled)I.focus(),I.select?.();else{const E=document.getElementById(`qty-main-${r}`);E?.focus(),E?.select?.()}},200))}else J(null),setTimeout(()=>{const o=document.getElementById(`qty-sec-${r}`);if(L==="Wholesale"&&o&&!o.disabled)o.focus(),o.select?.();else{const c=document.getElementById(`qty-main-${r}`);c?.focus(),c?.select?.()}},200)}},id:`row-name-${r}`}),Y!==r&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-2 pointer-events-none",children:e.jsxs("div",{className:x("px-3 py-1 rounded-xl text-[13px] font-black shadow-sm border-2 transition-all flex items-center gap-1.5",t.stock<10?"bg-rose-50 text-rose-600 border-rose-200 dark:bg-rose-900/30 dark:text-rose-400 dark:border-rose-800/50":"bg-emerald-50 text-emerald-600 border-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-400 dark:border-emerald-800/50"),children:[e.jsx(Pe,{size:14,className:"opacity-70"}),t.stock]})}),Y===r&&ne&&e.jsx("div",{className:"dropdown-premium min-w-[400px] mt-2",children:e.jsx("div",{ref:me,className:"max-h-64 overflow-y-auto no-scrollbar",children:N.filter(a=>{const i=ne.toLowerCase();return(a.name||"").toLowerCase().includes(i)||(a.code||"").toLowerCase().includes(i)||(a.active_ingredient||"").toLowerCase().includes(i)}).sort((a,i)=>{const s=ne.toLowerCase(),o=(a.name||"").toLowerCase(),c=(i.name||"").toLowerCase(),f=o.startsWith(s),j=c.startsWith(s);return f&&!j?-1:!f&&j?1:a.code?.toLowerCase()===s&&i.code?.toLowerCase()!==s?-1:a.code?.toLowerCase()!==s&&i.code?.toLowerCase()===s?1:o.localeCompare(c,"vi",{sensitivity:"base"})}).slice(0,10).map((a,i)=>e.jsxs("div",{onClick:()=>{let s=[...p];const o=s[r].quantity,c=s.findIndex((f,j)=>j!==r&&f.product_id===a.id);c>-1?(s[c].quantity+=o,s[c].secondary_qty=s[c].quantity/(s[c].multiplier||1),s.splice(r,1)):s[r]={...s[r],product_id:a.id,product_name:a.name,unit:a.unit,secondary_unit:a.secondary_unit,multiplier:a.multiplier||1,price:w[a.id]!==void 0?w[a.id]:a.sale_price,cost_price:a.cost_price,stock:a.stock,is_combo:a.is_combo,secondary_qty:o/(a.multiplier||1),active_ingredient:a.active_ingredient},C(s),J(null)},className:x("dropdown-item flex justify-between items-center",i===le&&"active"),children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-black text-gray-800 dark:text-gray-100 uppercase tracking-tight",children:a.name}),e.jsxs("div",{className:"text-[11px] text-gray-500 uppercase font-black flex items-center gap-2",children:[e.jsx("span",{children:a.unit}),e.jsx("span",{className:"w-1 h-1 rounded-full bg-gray-300"}),e.jsxs("div",{className:x("px-2.5 py-0.5 rounded-lg text-[12px] font-black border transition-all flex items-center gap-1.5 shadow-sm",i===le?"bg-white !text-emerald-700 border-white":a.stock<10?"bg-rose-50 text-rose-600 border-rose-200 dark:bg-rose-900/30 dark:text-rose-400 dark:border-rose-800/50":"bg-emerald-50 text-emerald-600 border-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-400 dark:border-emerald-800/50"),children:[e.jsx(Pe,{size:12,className:"opacity-70"}),a.stock]})]})]}),e.jsx("div",{className:"text-right font-black text-primary dark:text-[#d4a574]",children:v(a.sale_price)})]},a.id))})}),t.is_combo&&e.jsx("span",{className:"ml-2 bg-primary/10 text-primary dark:text-[#d4a574] text-[9px] px-1.5 py-0.5 rounded font-black uppercase",children:"Combo"}),t.active_ingredient&&e.jsxs("div",{className:"absolute left-0 bottom-full mb-2 hidden group-hover/search-row:block z-[2000] w-64 bg-slate-800 text-white p-3 rounded-xl shadow-2xl animate-in fade-in slide-in-from-bottom-2 duration-200 border border-slate-700",children:[e.jsx("div",{className:"text-[10px] font-black uppercase text-[#d4a574] mb-1 tracking-widest border-b border-white/10 pb-1",children:"Ho·∫°t ch·∫•t / Th√†nh ph·∫ßn"}),e.jsx("div",{className:"text-xs font-bold leading-relaxed",children:t.active_ingredient})]})]})}),e.jsxs("td",{className:"p-4 text-center",children:[e.jsx("div",{className:"font-bold text-gray-700 dark:text-gray-200",children:t.unit}),t.secondary_unit&&e.jsxs("div",{className:"text-[10px] text-primary dark:text-[#d4a574] font-black uppercase tracking-tighter",children:["1 ",t.secondary_unit," = ",t.multiplier," ",t.unit]})]}),e.jsx("td",{className:"p-2 w-32",children:t.secondary_unit?e.jsxs("div",{className:"flex items-center gap-1 h-9 px-2 bg-amber-50/50 dark:bg-amber-900/10 border-2 border-dashed border-[#d4a574]/40 rounded-xl focus-within:border-primary dark:focus-within:border-[#4a7c59] focus-within:ring-4 focus-within:ring-primary/10 shadow-sm transition-all text-primary dark:text-[#d4a574]",children:[e.jsx("input",{type:"number",className:"w-full bg-transparent text-center font-black text-base outline-none placeholder:text-gray-300",value:t.secondary_qty,onFocus:a=>a.target.select(),autoComplete:"off",onChange:a=>ze(r,"secondary_qty",parseFloat(a.target.value)||0),onKeyDown:a=>{if(a.key==="ArrowDown"){a.preventDefault();const i=r+1;i<p.length&&document.getElementById(`qty-sec-${i}`)?.focus()}else if(a.key==="ArrowUp"){a.preventDefault();const i=r-1;i>=0&&document.getElementById(`qty-sec-${i}`)?.focus()}},id:`qty-sec-${r}`}),e.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase pr-2",children:t.secondary_unit})]}):e.jsx("div",{className:"text-center text-gray-300 italic text-[10px] font-bold",children:"N/A"})}),e.jsx("td",{className:"p-2 w-24 group/qty",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"number",className:"w-full h-9 text-center bg-white dark:bg-slate-800 border-2 border-[#d4a574]/20 rounded-xl focus:border-primary dark:focus:border-[#4a7c59] focus:ring-4 focus:ring-primary/10 outline-none font-black text-lg text-primary dark:text-[#d4a574] shadow-sm transition-all placeholder:text-gray-300",value:t.quantity,onFocus:a=>a.target.select(),autoComplete:"off",onChange:a=>ze(r,"quantity",parseFloat(a.target.value)||0),ref:a=>Mt.current[t.product_id]=a,id:`qty-main-${r}`,onKeyDown:a=>{if(a.key==="Enter")a.preventDefault(),U.current?.focus();else if(a.key==="Tab")a.preventDefault(),document.getElementById(`price-${r}`)?.focus();else if(a.key==="ArrowDown"){a.preventDefault();const i=r+1;i<p.length&&document.getElementById(`qty-main-${i}`)?.focus()}else if(a.key==="ArrowUp"){a.preventDefault();const i=r-1;i>=0?document.getElementById(`qty-main-${i}`)?.focus():Z.current?.focus()}}}),e.jsx("button",{tabIndex:-1,className:"absolute -top-2 -right-2 w-5 h-5 flex items-center justify-center bg-[#8b6f47] text-white rounded-full shadow-md hover:bg-[#8b6f47]/90 active:scale-95 z-[70] transition-all hover:scale-110 border border-white dark:border-slate-800 opacity-0 group-hover/qty:opacity-100 duration-200",onClick:()=>ze(r,"quantity",t.quantity*-1),title:"ƒê·ªïi th√†nh Tr·∫£ H√†ng (√Çm)",children:e.jsx(De,{size:10,strokeWidth:3})})]})}),e.jsx("td",{className:"p-2 text-right",children:e.jsxs("div",{className:"relative group/price",children:[e.jsx("input",{type:"text",className:x("w-full p-2 text-right bg-transparent border-none focus:ring-2 rounded font-bold transition-all outline-none",t.price<t.cost_price?"text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 focus:ring-red-200 dark:focus:ring-red-900":"text-primary dark:text-[#d4a574] focus:ring-primary/20 dark:focus:ring-[#4a7c59]/20"),value:v(t.price),onFocus:a=>a.target.select(),autoComplete:"off",onChange:a=>{const i=parseFloat(a.target.value.replace(/,/g,""))||0;ze(r,"price",i)},onKeyDown:a=>{if(a.key==="Enter"||a.key==="Tab")a.preventDefault(),U.current?.focus();else if(a.key==="ArrowDown"){a.preventDefault();const i=r+1;i<p.length&&document.getElementById(`price-${i}`)?.focus()}else if(a.key==="ArrowUp"){a.preventDefault();const i=r-1;i>=0?document.getElementById(`price-${i}`)?.focus():Fe.current?.focus()}},id:`price-${r}`}),t.price<t.cost_price&&e.jsxs("div",{className:"absolute -top-10 right-0 bg-red-600 text-white text-xs px-4 py-1.5 rounded-full font-black whitespace-nowrap z-[100] flex items-center gap-1.5 shadow-xl pointer-events-none uppercase tracking-tighter border-2 border-white dark:border-red-900",children:[e.jsx(Tt,{size:14,fill:"white",className:"text-red-600"}),"L·ªñ V·ªêN (G·ªëc: ",yt(t.cost_price),")"]})]})}),e.jsxs("td",{className:"p-4 text-right",children:[e.jsx("div",{className:x("font-black text-lg transition-colors",t.quantity<0?"text-red-600 dark:text-red-400":"text-primary dark:text-[#d4a574]"),children:v(t.price*t.quantity)}),t.quantity<0&&e.jsx("span",{className:"inline-block px-2 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded text-[9px] font-black uppercase tracking-widest border border-red-200 dark:border-red-800/50 mt-1",children:"H√†ng tr·∫£"})]}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("button",{onClick:a=>{a.stopPropagation(),ar(r)},className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-xl transition-all opacity-0 group-hover:opacity-100",title:"X√≥a d√≤ng",children:e.jsx(qt,{size:18})})})]},`cart-row-${r}`))})]})]})]})}),e.jsx(O,{children:!xe&&e.jsxs(e.Fragment,{children:[e.jsx(m.div,{layout:!0,initial:{scale:.8,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0,y:20},className:"absolute bottom-10 left-10 z-[110] pointer-events-none",children:e.jsxs("div",{onClick:()=>setIsPartnerModalOpen(!0),className:"bg-white/90 dark:bg-slate-800/90 backdrop-blur-3xl px-6 py-4 rounded-[2rem] shadow-[0_20px_50px_rgba(0,0,0,0.1)] border border-white/40 flex items-center gap-4 group/partner-bubble cursor-pointer hover:scale-105 active:scale-95 transition-all duration-300 pointer-events-auto hover:bg-white dark:hover:bg-slate-800",children:[e.jsx("div",{className:"w-12 h-12 bg-[#8b6f47] dark:bg-[#d4a574] rounded-2xl flex items-center justify-center text-white shadow-lg shadow-[#8b6f47]/20 group-hover/partner-bubble:rotate-12 transition-transform",children:e.jsx(ye,{size:24})}),e.jsxs("div",{className:"flex flex-col min-w-0 max-w-[280px]",children:[e.jsx("div",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-muted dark:text-[#d4a574]/60 mb-0.5",children:"ƒê·ªëi t√°c / Kh√°ch h√†ng"}),e.jsx("div",{className:"text-xl font-black text-primary dark:text-white uppercase leading-tight tracking-tight truncate py-0.5",children:d?d.name:"Kh√°ch b√°n l·∫ª"}),d?.address&&e.jsxs("div",{className:"flex items-center gap-1.5 mt-1.5 text-[10px] font-bold text-muted/70 dark:text-[#d4a574]/80 truncate",children:[e.jsx(zt,{size:10,strokeWidth:2.5,className:"shrink-0"}),e.jsx("span",{className:"truncate",children:d.address})]})]})]})},"partner-bubble"),e.jsx(m.div,{layout:!0,initial:{scale:.8,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0,y:20},className:"absolute bottom-10 right-10 z-[110] pointer-events-none",children:e.jsxs("div",{className:"bg-[#8b6f47]/90 dark:bg-[#d4a574]/90 backdrop-blur-3xl text-white px-8 py-4 rounded-[2rem] shadow-[0_20px_50px_rgba(139,111,71,0.5)] border border-white/20 flex flex-col items-end group/total cursor-pointer hover:scale-105 active:scale-95 transition-all duration-300 pointer-events-auto hover:bg-[#8b6f47] dark:hover:bg-[#d4a574]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-white/50 animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.2em] opacity-80",children:"T·ªïng c·ªông thanh to√°n"})]}),e.jsxs("div",{className:"text-4xl font-black tracking-tighter tabular-nums drop-shadow-lg flex items-baseline gap-1",children:[v(z),e.jsx("span",{className:"text-sm opacity-60 font-bold",children:"ƒë"})]})]})},"total-bubble")]})})]})})}),e.jsx(m.div,{initial:!1,animate:{width:xe?"22%":"90px"},transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col bg-transparent pr-1 min-h-0 relative",children:e.jsx("div",{className:"p-1 transition-colors relative flex-1 flex flex-col min-h-0",children:e.jsxs(O,{mode:"wait",children:[!xe&&e.jsxs(m.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"flex flex-col items-center py-4 gap-8 h-full relative z-10",children:[e.jsx("div",{className:x("w-14 h-14 rounded-2xl flex items-center justify-center border-2 transition-all shadow-lg",d?"bg-[#8b6f47] text-white border-white/20":"bg-white/50 dark:bg-slate-800/50 text-muted border-white/50"),children:e.jsx(ye,{size:24})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(m.button,{whileHover:{scale:1.15},whileTap:{scale:.9},onClick:()=>st(!0),className:"w-16 h-16 bg-white dark:bg-slate-800 rounded-full flex items-center justify-center text-[#8b6f47] dark:text-[#d4a574] border-2 border-[#d4a574]/30 shadow-xl hover:shadow-2xl transition-all group/toggle",children:e.jsx(St,{size:32,strokeWidth:3,className:"group-hover/toggle:-translate-x-1 transition-transform"})})}),e.jsxs("div",{className:"flex flex-col gap-3 pb-4",children:[e.jsx(m.button,{whileHover:{scale:1.1,y:-2},whileTap:{scale:.9},onClick:Ge,disabled:p.length===0,className:"w-14 h-14 bg-white/80 dark:bg-slate-800/80 rounded-2xl flex items-center justify-center text-[#8b6f47] border-2 border-[#d4a574]/30 shadow-md hover:shadow-lg transition-all",title:"Treo ƒë∆°n",children:e.jsx(ke,{size:24})}),e.jsx(m.button,{whileHover:{scale:1.1,y:-2},whileTap:{scale:.9},onClick:()=>ee(!1),disabled:p.length===0||F,className:"w-14 h-14 bg-white/80 dark:bg-slate-800/80 rounded-2xl flex items-center justify-center text-primary border-2 border-primary/30 shadow-md hover:shadow-lg transition-all",title:"Ch·ªâ l∆∞u",children:F?e.jsx("div",{className:"w-5 h-5 border-3 border-primary/30 border-t-primary rounded-full animate-spin"}):e.jsx(Dt,{size:24})}),e.jsx(m.button,{whileHover:{scale:1.1,y:-2},whileTap:{scale:.9},onClick:()=>ee(!0),disabled:p.length===0||F,className:"w-14 h-14 bg-primary text-white rounded-2xl flex items-center justify-center shadow-lg shadow-primary/30 hover:shadow-primary/50 animate-pulse-smooth border border-white/20 transition-all",title:"In h√≥a ƒë∆°n",children:F?e.jsx("div",{className:"w-5 h-5 border-3 border-white/30 border-t-white rounded-full animate-spin"}):e.jsx(Pt,{size:28})})]})]},"mini-sidebar"),xe&&e.jsxs(m.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.2},className:"h-full flex flex-col relative",children:[e.jsx(m.button,{whileHover:{scale:1.15,x:1},whileTap:{scale:.95},onClick:()=>st(!1),className:"absolute -left-4 top-1/2 -translate-y-1/2 w-9 h-9 bg-white dark:bg-slate-800 rounded-full flex items-center justify-center text-[#8b6f47] dark:text-[#d4a574] border-2 border-[#d4a574]/30 z-[130] shadow-[0_4px_20px_rgba(0,0,0,0.15)] hover:shadow-[0_8px_30px_rgba(0,0,0,0.2)] transition-all group/toggle-open",children:e.jsx(tt,{size:18,strokeWidth:4,className:"group-hover/toggle-open:translate-x-0.5 transition-transform"})}),e.jsxs("div",{className:"flex flex-col gap-3 relative z-10 flex-1 overflow-y-auto -mr-2 pr-2 pb-2",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{onClick:()=>setIsPartnerModalOpen(!0),className:"flex items-center gap-4 bg-white/50 dark:bg-slate-800/50 backdrop-blur-xl p-4 rounded-[1.5rem] border border-white/50 dark:border-white/10 shadow-sm transition-all hover:shadow-md group/partner cursor-pointer hover:bg-white/60 dark:hover:bg-slate-800/70",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-[#8b6f47]/10 to-[#8b6f47]/20 rounded-2xl shadow-inner flex items-center justify-center text-[#8b6f47] dark:text-[#d4a574] border border-white dark:border-slate-800 transition-transform group-hover/partner:scale-105 duration-500 shrink-0",children:e.jsx(ye,{size:24})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[10px] font-black text-muted dark:text-[#d4a574]/60 uppercase tracking-[0.2em]",children:"ƒê·ªëi t√°c"}),e.jsx("div",{className:"font-black text-primary dark:text-white text-lg uppercase leading-tight truncate group-hover/partner:text-[#8b6f47] transition-colors",children:d?d.name:"Kh√°ch b√°n l·∫ª"}),d?.address&&e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-bold text-muted/80 dark:text-[#d4a574]/80 truncate mt-1",children:[e.jsx(zt,{size:8,strokeWidth:2.5}),e.jsx("span",{className:"truncate",children:d.address})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-3 text-primary/40 dark:text-[#d4a574]/40 z-10",children:e.jsx(It,{size:16})}),e.jsx("textarea",{placeholder:"Ghi ch√∫ ƒë∆°n h√†ng...",className:"w-full pl-9 p-3 bg-white/50 dark:bg-slate-800/50 backdrop-blur-xl border border-white/40 dark:border-white/10 rounded-[1.5rem] focus:bg-white/70 dark:focus:bg-slate-800/70 focus:border-primary/50 dark:focus:border-[#4a7c59] outline-none transition-all resize-none h-14 text-xs italic dark:text-gray-300 shadow-sm hover:shadow-md",value:$,onChange:t=>V(t.target.value)})]})]}),e.jsxs("div",{className:"flex-1 space-y-3 pt-1",children:[e.jsxs("div",{className:x("p-4 rounded-[1.5rem] border border-white/40 dark:border-white/10 shadow-sm transition-all duration-500 bg-white/50 dark:bg-slate-800/50 backdrop-blur-xl hover:shadow-md",z>0?"border-primary/30 shadow-primary/10":""),children:[e.jsx("div",{className:"text-[10px] font-black text-muted dark:text-[#d4a574]/80 uppercase tracking-widest mb-1 text-center",children:"T·ªïng thanh to√°n"}),e.jsx("div",{className:"font-black text-3xl text-primary dark:text-[#f4c430] text-center whitespace-nowrap overflow-hidden",children:v(z)})]}),e.jsxs("div",{className:"space-y-3 px-1",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white/50 dark:bg-slate-800/50 backdrop-blur-xl p-3 rounded-[1.2rem] border border-white/40 dark:border-white/10 shadow-sm hover:shadow-md transition-all",children:[e.jsx("span",{className:"text-[10px] font-black text-muted/60 dark:text-[#d4a574]/40 uppercase tracking-widest",children:"N·ª£ c≈©:"}),e.jsx("span",{className:"font-black text-sm text-red-500 dark:text-red-400/80",children:v(Te)})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex bg-white/50 dark:bg-slate-800/50 backdrop-blur-xl p-1.5 rounded-[1.2rem] gap-1 border border-white/40 dark:border-white/10 shadow-sm hover:shadow-md transition-all",children:[e.jsx("button",{onClick:()=>k("Cash"),className:x("flex-1 py-1.5 rounded-lg text-[9px] font-black transition-all",h==="Cash"?"bg-primary text-white shadow-md":"text-primary/60 hover:text-primary dark:text-[#d4a574]/60"),children:"TI·ªÄN M·∫∂T"}),e.jsx("button",{onClick:()=>{k("Debt"),y(0)},className:x("flex-1 py-1.5 rounded-lg text-[9px] font-black transition-all",h==="Debt"?"bg-[#8b6f47] text-white shadow-md":"text-muted/60 hover:text-muted dark:text-[#d4a574]/60"),children:"C√îNG N·ª¢"}),e.jsx("button",{onClick:()=>{k("Pending"),y(0)},className:x("flex-1 py-1.5 rounded-lg text-[9px] font-black transition-all",h==="Pending"?"bg-[#f4c430] text-white shadow-md":"text-[#f4c430]/60 hover:text-[#f4c430] dark:text-[#d4a574]/60"),children:"CH·ªú T/T"}),e.jsx("button",{onClick:()=>{k("Transfer")},className:x("flex-1 py-1.5 rounded-lg text-[9px] font-black transition-all",h==="Transfer"?"bg-blue-600 text-white shadow-md":"text-blue-600/60 hover:text-blue-600 dark:text-[#d4a574]/60"),children:"CHUY·ªÇN KHO·∫¢N"})]}),h==="Transfer"&&e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[9px] font-black text-blue-400 uppercase z-10",children:"TK Nh·∫≠n:"}),e.jsx("select",{className:"w-full p-2.5 pl-20 bg-white/50 dark:bg-slate-800/50 backdrop-blur-xl border border-blue-200 dark:border-blue-900/30 rounded-[1.2rem] font-bold text-xs outline-none focus:ring-2 focus:ring-blue-500/20 transition-all dark:text-white",value:it,onChange:t=>nt(t.target.value),children:Et.map(t=>e.jsxs("option",{value:t.id,children:[t.bank_name," - ",t.account_number]},t.id))})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[10px] font-black text-muted/40 uppercase z-10",children:"Thanh to√°n:"}),e.jsx("input",{type:"text",readOnly:h==="Cash"||h==="Pending",className:x("w-full p-2.5 pl-24 text-right rounded-[1.2rem] font-black text-xl outline-none border border-white/40 dark:border-white/10 shadow-sm bg-white/50 dark:bg-slate-800/50 backdrop-blur-xl transition-all hover:shadow-md",h==="Cash"||h==="Pending"?"text-primary/40 cursor-default":"text-primary dark:text-[#d4a574] focus:ring-2 focus:ring-primary/20 bg-white/70"),value:v(u),autoComplete:"off",onChange:t=>y(parseFloat(t.target.value.replace(/,/g,""))||0)})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3 pt-3",children:[e.jsxs("div",{className:"bg-gradient-to-br from-primary to-primary-hover text-white p-5 rounded-[1.5rem] flex items-center justify-between shadow-lg hover:shadow-xl transition-all hover:scale-[1.02] active:scale-95 border border-white/10 relative z-20",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-[10px] font-black uppercase opacity-70 tracking-[0.1em] block mb-1",children:"N·ª£ sau ƒë∆°n:"}),e.jsx("span",{className:"text-3xl font-black tracking-tighter block leading-none",children:v(Xt)})]}),e.jsx(hr,{className:"text-white/20 shrink-0 ml-2 animate-pulse",size:32})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m.button,{whileTap:{scale:.95},disabled:p.length===0,onClick:Ge,className:"flex-1 bg-white/80 dark:bg-slate-800/80 text-[#8b6f47] dark:text-[#d4a574] rounded-full font-black hover:bg-[#d4a574]/10 transition-all border-2 border-[#d4a574]/20 flex items-center justify-center gap-3 p-3",children:[e.jsx(ke,{size:20,className:"shrink-0"}),e.jsx("span",{className:"text-lg uppercase tracking-widest font-black",children:"TREO"})]}),e.jsxs(m.button,{whileTap:{scale:.95},disabled:p.length===0||F,onClick:()=>ee(!1),className:"flex-1 bg-white/80 dark:bg-slate-800/80 text-primary dark:text-[#d4a574] rounded-full font-black hover:bg-primary/5 transition-all border-2 border-primary/20 flex items-center justify-center gap-3 p-3",children:[e.jsx(Dt,{size:20,className:"shrink-0"}),e.jsx("span",{className:"text-lg uppercase tracking-widest font-black",children:"L∆ØU"})]})]}),e.jsx(m.button,{whileTap:{scale:.98},disabled:p.length===0||F,onClick:()=>ee(!0),className:x("w-full bg-gradient-to-r from-primary to-primary-hover text-white rounded-full flex items-center justify-center border border-white/20 transition-all p-4 h-16 relative z-20",!F&&p.length>0?"animate-pulse-smooth":""),children:F?e.jsx("div",{className:"w-6 h-6 border-4 border-white/30 border-t-white rounded-full animate-spin"}):e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pt,{size:28,className:"shrink-0"}),e.jsx("span",{className:"text-3xl tracking-widest uppercase font-black",children:"IN"})]})})]})]})]},"expanded-sidebar")]})})})]}),e.jsx(O,{children:je&&e.jsx(jt,{isOpen:je,partner:{name:lt,is_customer:!0,is_supplier:!1},onClose:()=>Ne(!1),onSave:()=>{fe(),Ne(!1)}})}),e.jsx(O,{children:_e&&e.jsx(vt,{isOpen:_e,product:{name:lt},onClose:()=>Ce(!1),onSave:()=>{he(),Ce(!1)}})}),e.jsx(O,{children:He&&e.jsx(dr,{message:He.message,type:He.type,onClose:()=>ie(null)})}),e.jsx(vt,{isOpen:$e,product:Ht,onClose:()=>oe(!1),onSave:he}),e.jsx(jt,{isOpen:$t,partner:Ft,onClose:()=>Qe(!1),onSave:async()=>{if(await fe(),d){const r=(await D.get("/api/partners")).data.find(a=>a.id===d.id);r&&_(r)}}}),e.jsx(O,{children:Me&&dt&&e.jsx(Xe,{children:e.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-300 font-sans",children:e.jsxs(m.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-slate-900 w-full max-w-4xl max-h-[90vh] rounded-[3rem] shadow-2xl overflow-hidden border border-white dark:border-emerald-900/30 flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b dark:border-emerald-900/30 flex justify-between items-center bg-gray-50 dark:bg-emerald-950/20",children:[e.jsxs("h2",{className:"text-xl font-black text-gray-800 dark:text-emerald-400 uppercase tracking-tighter flex items-center gap-3",children:[e.jsx(_t,{size:24,className:"text-primary"}),"Xem tr∆∞·ªõc n·ªôi dung in"]}),e.jsx("button",{onClick:()=>ue(!1),className:"p-2 hover:bg-gray-200 dark:hover:bg-slate-800 rounded-xl transition-all",children:e.jsx(we,{size:24})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-10 bg-gray-100 dark:bg-slate-950 flex justify-center",children:e.jsx("div",{className:"bg-white shadow-2xl h-fit",children:e.jsx(wt,{data:dt,settings:K,type:"Sale",isPreview:!0})})}),e.jsxs("div",{className:"p-6 border-t dark:border-emerald-900/30 flex gap-4 bg-gray-50 dark:bg-emerald-950/10",children:[e.jsxs(m.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>ue(!1),className:"flex-1 bg-white dark:bg-slate-800 text-[#8b6f47] dark:text-[#d4a574]/80 border-2 border-[#d4a574]/30 py-4 rounded-2xl font-black uppercase tracking-widest text-xs hover:bg-[#d4a574]/10 hover:text-[#2d5016] dark:hover:text-[#d4a574] transition-all flex items-center justify-center gap-2",children:[e.jsx(fr,{size:18,strokeWidth:2.5}),"ƒê√≥ng xem tr∆∞·ªõc"]}),e.jsx("button",{onClick:()=>{ue(!1),ee(!0)},className:"flex-1 bg-primary text-white py-4 rounded-2xl font-black uppercase tracking-widest text-xs hover:bg-emerald-700 shadow-lg shadow-emerald-500/20 transition-all",children:"L∆∞u & In th·ª±c t·∫ø"})]})]})})})}),e.jsx(cr,{isVisible:F&&N.length===0,message:"ƒêang n·∫°p d·ªØ li·ªáu POS..."}),e.jsx(Xe,{children:e.jsx(br,{isOpen:Qt,partner:d,onClose:()=>Ve(!1),onAddToCart:t=>{const r=N.find(a=>a.id===t.id);r&&be(r)}})})]}),b&&b.details&&b.details.length>0&&e.jsx("div",{className:"only-print",children:e.jsx(wt,{data:b,settings:K,type:"Sale"})})]})}export{qr as default};
