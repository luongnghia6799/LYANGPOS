import{r,j as e}from"./vendor-C23Namvk.js";import{a as w}from"./vendor-utils-C44aPrMG.js";import{P as X,c as A}from"./index-UsWd1F3S.js";import{O as Y}from"./OrderEditPopup-D_7BTVt5.js";import{T as Z}from"./Toast-DQljrx14.js";import{b as V,a5 as W,c as ee,W as te,at as ae,au as se,d as K,af as R,$ as E,U as G,R as re,q as le}from"./vendor-icons-B3K5gD8o.js";import{A as P,m as L}from"./vendor-framer-DVZK1f_z.js";const O=({active:i,onClick:o,icon:m,label:d})=>e.jsxs("button",{onClick:o,className:A("relative px-5 py-2.5 rounded-xl text-sm font-bold transition-all duration-300 flex items-center gap-2 overflow-hidden",i?"text-white":"text-[#8b6f47] dark:text-[#d4a574]/60 hover:text-[#2d5016] dark:hover:text-[#d4a574] hover:bg-white/30 dark:hover:bg-slate-700/30"),children:[i&&e.jsx(L.div,{layoutId:"summaryTabIndicator",className:"absolute inset-0 bg-gradient-to-r from-[#2d5016] to-[#4a7c59] shadow-lg shadow-[#2d5016]/30",transition:{type:"spring",bounce:.2,duration:.6}}),e.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:[m,d]})]}),S=({title:i,value:o,isMoney:m=!0,gradient:d="bg-primary",icon:b})=>e.jsxs(L.div,{whileHover:{y:-8,scale:1.02},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:A("relative group overflow-hidden rounded-3xl p-6 shadow-xl border border-white/10 text-white transition-all duration-500",d),children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-12 -mt-12 group-hover:scale-150 transition-transform duration-700 blur-2xl"}),e.jsxs("div",{className:"relative z-10 flex flex-col h-full justify-between",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"p-3 bg-white/20 rounded-2xl backdrop-blur-md shadow-inner",children:b})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] mb-1 opacity-80",children:i}),e.jsxs("div",{className:"text-2xl font-black tracking-tight flex items-baseline gap-1",children:[m?(Number(o)||0).toLocaleString():o,m&&e.jsx("span",{className:"text-xs font-bold opacity-60",children:"₫"})]})]})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000 pointer-events-none"})]}),be=()=>{const[i,o]=r.useState("transactions"),[m,d]=r.useState(null),[b,p]=r.useState(null),v=async c=>{if(!c)return;const g=c.display_id||c.ref_id||"";if(c.isVoucher||c.category==="Voucher"||g.startsWith("PT-")||g.startsWith("PC-")){p({message:`Đây là phiếu thu/chi (${g}). Vui lòng xem chi tiết tại tab Sổ Quỹ.`,type:"info"});return}let y=c;const u=g;if((!c.details||!Array.isArray(c.details))&&u)try{const s=u.replace("#",""),n=await w.get("/api/orders",{params:{search_id:s}}),a=Array.isArray(n.data)?n.data.find(h=>h.display_id===u):(n.data.items||[]).find(h=>h.display_id===u);a&&(y=a)}catch(s){console.error("Error fetching order details:",s)}y&&d(y)};return e.jsxs("div",{className:"flex h-screen flex-col font-sans transition-colors duration-300 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] rounded-full bg-primary opacity-[0.05] blur-[100px] pointer-events-none"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] rounded-full bg-emerald-500 opacity-[0.05] blur-[100px] pointer-events-none"}),e.jsxs("div",{className:"bg-transparent px-6 py-4 flex items-center justify-between z-30 sticky top-0",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-black flex items-center gap-3 drop-shadow-md py-1",children:[e.jsx(V,{className:"w-8 h-8 text-primary"}),e.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-primary to-emerald-600 uppercase leading-relaxed",children:"SỔ GIAO DỊCH & ĐỐI SOÁT"})]}),e.jsx("p",{className:"text-[10px] font-bold text-muted uppercase tracking-widest ml-11 opacity-70",children:"Theo dõi dòng tiền, công nợ đối tác và nhật ký kho hàng"})]}),e.jsxs("div",{className:"flex space-x-1.5 p-1.5 rounded-2xl glass-panel border-2 border-primary/20 backdrop-blur-md shadow-lg",children:[e.jsx(O,{active:i==="transactions",onClick:()=>o("transactions"),icon:e.jsx(W,{className:"w-4 h-4"}),label:"Nhật Ký Giao Dịch"}),e.jsx(O,{active:i==="partner",onClick:()=>o("partner"),icon:e.jsx(ee,{className:"w-4 h-4"}),label:"Sổ Công Nợ Đối Tác"}),e.jsx(O,{active:i==="inventory",onClick:()=>o("inventory"),icon:e.jsx(te,{className:"w-4 h-4"}),label:"Nhật Ký Kho Hàng"})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden relative z-20 p-4",children:e.jsx(P,{mode:"wait",children:e.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"linear"},className:"h-full",children:[i==="transactions"&&e.jsx(ne,{onEditOrder:v}),i==="partner"&&e.jsx(oe,{onEditOrder:v}),i==="inventory"&&e.jsx(de,{onEditOrder:v})]},i)})}),e.jsx(X,{children:e.jsx(P,{children:m&&e.jsx(Y,{order:m,onClose:()=>d(null),onSave:()=>d(null)})})}),e.jsx(P,{children:b&&e.jsx(Z,{message:b.message,type:b.type,onClose:()=>p(null)})})]})},ne=({onEditOrder:i})=>{const[o,m]=r.useState([]),[d,b]=r.useState(!0),[p,v]=r.useState({revenue:0,expense:0,count:0,customerDebt:0,supplierDebt:0}),[c,g]=r.useState(()=>{const t=new Date,k=t.getDay(),x=t.getDate()-k+(k===0?-6:1);return new Date(t.setDate(x)).toISOString().split("T")[0]}),[f,y]=r.useState(()=>new Date().toISOString().split("T")[0]),[u,s]=r.useState("All"),[n,a]=r.useState(""),[h,M]=r.useState(""),[j,N]=r.useState(1),[T,q]=r.useState(20),I=async()=>{b(!0);try{const t={start_date:c,end_date:f,type:u==="All"?null:u,search_id:n,search_partner:h},k={start_date:c,end_date:f,search_partner:h,search_id:n},[x,C,H]=await Promise.all([w.get("/api/orders",{params:t}),w.get("/api/cash-vouchers",{params:k}),w.get("/api/dashboard-stats")]),B=Array.isArray(x.data)?x.data:x.data.items||[],J=Array.isArray(C.data)?C.data:C.data.items||[],D=[...B.map(l=>({...l,isVoucher:!1})),...J.map(l=>({...l,isVoucher:!0,display_id:l.type==="Receipt"?`PT-${l.id}`:`PC-${l.id}`,total_amount:l.amount,partner_name:l.partner_name||"Hệ thống"}))].sort((l,Q)=>new Date(Q.date)-new Date(l.date)),F=h?D.filter(l=>(l.partner_name||"").toLowerCase().includes(h.toLowerCase())):D;m(F);let $=0,z=0;D.forEach(l=>{l.isVoucher?l.type==="Receipt"?$+=l.total_amount:z+=l.total_amount:(l.type==="Sale"&&($+=l.amount_paid),l.type==="Purchase"&&(z+=l.amount_paid))}),v({revenue:$,expense:z,count:D.length,customerDebt:H.data.customer_debt||0,supplierDebt:H.data.supplier_debt||0})}catch(t){console.error(t)}finally{b(!1)}};r.useEffect(()=>{N(1),I()},[c,f,u,n,h]);const _=Math.ceil(o.length/T),U=o.slice((j-1)*T,j*T);return e.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[e.jsx(S,{title:"Tổng Thu Tiền",value:p.revenue,gradient:"bg-gradient-to-br from-primary to-emerald-600",icon:e.jsx(ae,{size:20,strokeWidth:3})}),e.jsx(S,{title:"Tổng Chi Tiền",value:p.expense,gradient:"bg-gradient-to-br from-rose-500 to-rose-700",icon:e.jsx(se,{size:20,strokeWidth:3})}),e.jsx(S,{title:"Giao Dịch",value:p.count,isMoney:!1,gradient:"bg-gradient-to-br from-[#d4a574] to-[#f4c430]",icon:e.jsx(W,{size:20,strokeWidth:3})}),e.jsx(S,{title:"Tổng Phải Thu",value:p.customerDebt,gradient:"bg-gradient-to-br from-[#4a7c59] to-[#87ceeb]",icon:e.jsx(K,{size:20,strokeWidth:3})}),e.jsx(S,{title:"Tổng Phải Trả",value:p.supplierDebt,gradient:"bg-gradient-to-br from-[#8b6f47] to-[#6b4423]",icon:e.jsx(R,{size:20,strokeWidth:3})})]}),e.jsxs("div",{className:"bg-white/60 dark:bg-slate-800/60 backdrop-blur-lg p-4 rounded-2xl shadow-lg border-2 border-[#d4a574]/30 mb-4 flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{size:16,className:"text-[#4a7c59]"}),e.jsx("input",{type:"date",className:"bg-transparent border-b-2 border-[#d4a574]/20 outline-none text-sm font-bold text-[#2d5016]",value:c,onChange:t=>{g(t.target.value),N(1)}}),e.jsx("span",{className:"text-gray-400",children:"→"}),e.jsx("input",{type:"date",className:"bg-transparent border-b-2 border-[#d4a574]/20 outline-none text-sm font-bold text-[#2d5016]",value:f,onChange:t=>{y(t.target.value),N(1)}})]}),e.jsxs("select",{className:"bg-transparent border-b-2 border-[#d4a574]/20 outline-none text-sm font-bold text-[#2d5016]",value:u,onChange:t=>{s(t.target.value),N(1)},children:[e.jsx("option",{value:"All",children:"Tất cả loại"}),e.jsx("option",{value:"Sale",children:"Chỉ Bán Hàng"}),e.jsx("option",{value:"Purchase",children:"Chỉ Nhập Hàng"})]}),e.jsxs("div",{className:"flex-1 min-w-[180px] relative",children:[e.jsx(E,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-[#8b6f47]"}),e.jsx("input",{type:"text",placeholder:"Mã chứng từ...",className:"w-full pl-9 pr-4 py-2 bg-white/50 dark:bg-slate-900/50 border-2 border-[#d4a574]/20 rounded-xl text-sm outline-none focus:ring-2 ring-[#2d5016]/20 font-medium",value:n,onChange:t=>{a(t.target.value),N(1)}})]}),e.jsxs("div",{className:"flex-1 min-w-[180px] relative",children:[e.jsx(G,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-[#8b6f47]"}),e.jsx("input",{type:"text",placeholder:"Tên khách hàng...",className:"w-full pl-9 pr-4 py-2 bg-white/50 dark:bg-slate-900/50 border-2 border-[#d4a574]/20 rounded-xl text-sm outline-none focus:ring-2 ring-[#2d5016]/20 font-medium",value:h,onChange:t=>{M(t.target.value),N(1)}})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] font-bold text-[#8b6f47] uppercase",children:"Hiển thị:"}),e.jsxs("select",{value:T,onChange:t=>{q(parseInt(t.target.value)),N(1)},className:"bg-transparent border-b-2 border-[#d4a574]/20 outline-none text-sm font-bold text-[#2d5016]",children:[e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]}),e.jsx("button",{onClick:I,className:"p-2 hover:bg-white/50 rounded-xl text-[#4a7c59] transition-colors border-2 border-transparent hover:border-[#d4a574]/30",children:e.jsx(re,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex-1 bg-white/60 dark:bg-slate-800/60 backdrop-blur-xl rounded-2xl shadow-xl border-2 border-[#d4a574]/30 overflow-hidden flex flex-col",children:[e.jsx("div",{className:"overflow-auto flex-1",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-[#2d5016]/10 sticky top-0 z-10 border-b-2 border-[#d4a574]/40 backdrop-blur-md",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 font-bold text-[#2d5016]",children:"Ngày giờ"}),e.jsx("th",{className:"px-6 py-4 font-bold text-[#2d5016]",children:"Chứng Từ"}),e.jsx("th",{className:"px-6 py-4 font-bold text-[#2d5016]",children:"Loại"}),e.jsx("th",{className:"px-6 py-4 font-bold text-[#2d5016]",children:"Đối Tác"}),e.jsx("th",{className:"px-6 py-4 font-bold text-[#2d5016] text-right",children:"Giá Trị"}),e.jsx("th",{className:"px-6 py-4 font-bold text-[#2d5016]",children:"Ghi Chú"})]})}),e.jsx("tbody",{className:"divide-y divide-[#d4a574]/10",children:d?e.jsx("tr",{className:"animate-shimmer-fast",children:e.jsx("td",{colSpan:"6",className:"text-center py-10 font-black opacity-50",children:"Đang tải dữ liệu, vui lòng chờ..."})}):o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-10",children:"Không có dữ liệu"})}):e.jsx(P,{mode:"popLayout",children:U.map((t,k)=>e.jsxs(L.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2,delay:Math.min(k*.03,.3)},className:"hover:bg-[#d4a574]/5 transition-colors border-b border-[#d4a574]/10",children:[e.jsx("td",{className:"px-6 py-3 text-xs",children:new Date(t.date).toLocaleString("vi-VN")}),e.jsx("td",{className:"px-6 py-3 font-bold text-[#2d5016] cursor-pointer hover:underline",onClick:()=>i(t),children:t.display_id}),e.jsx("td",{className:"px-6 py-3",children:e.jsx("span",{className:A("px-2 py-1 rounded-md text-[10px] font-black uppercase whitespace-nowrap shadow-sm border",t.type==="Sale"&&t.payment_method!=="Debt"&&"bg-emerald-100 text-emerald-700 border-emerald-200",t.type==="Sale"&&t.payment_method==="Debt"&&"bg-purple-100 text-purple-700 border-purple-200",t.type==="Purchase"&&t.payment_method!=="Debt"&&"bg-amber-100 text-amber-700 border-amber-200",t.type==="Purchase"&&t.payment_method==="Debt"&&"bg-orange-100 text-orange-700 border-orange-200",t.type==="Receipt"&&"bg-blue-100 text-blue-700 border-blue-200",t.type==="Payment"&&"bg-rose-100 text-rose-700 border-rose-200"),children:t.isVoucher?t.type==="Receipt"?"Phiếu thu":"Phiếu chi":`${t.type==="Sale"?"Bán hàng":"Nhập hàng"} • ${t.payment_method==="Debt"?"Ghi nợ":t.payment_method||"Tiền mặt"}`})}),e.jsx("td",{className:"px-6 py-3 font-medium",children:t.partner_name}),e.jsxs("td",{className:"px-6 py-3 text-right font-black",children:[(t.total_amount||0).toLocaleString()," ₫"]}),e.jsx("td",{className:"px-6 py-3 text-xs italic opacity-60 truncate max-w-xs",children:t.note})]},`${t.isVoucher?"v":"o"}-${t.id}`))})})]})}),o.length>0&&e.jsxs("div",{className:"px-6 py-4 bg-[#2d5016]/5 border-t-2 border-[#d4a574]/20 flex justify-between items-center bg-[#faf8f3]/30 backdrop-blur-md",children:[e.jsxs("div",{className:"text-xs font-bold text-[#8b6f47]",children:["Hiển thị ",e.jsxs("span",{className:"text-[#2d5016]",children:[(j-1)*T+1," - ",Math.min(j*T,o.length)]})," trên tổng số ",e.jsx("span",{className:"text-[#2d5016]",children:o.length})," giao dịch"]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{disabled:j===1,onClick:()=>N(t=>Math.max(1,t-1)),className:"px-4 py-2 border-2 border-[#d4a574]/30 rounded-xl text-[10px] font-black uppercase tracking-widest disabled:opacity-30 hover:bg-[#d4a574]/10 transition-all text-[#2d5016]",children:"Trước"}),[...Array(_)].map((t,k)=>{const x=k+1;return x===1||x===_||x>=j-2&&x<=j+2?e.jsx("button",{onClick:()=>N(x),className:A("w-9 h-9 rounded-xl text-xs font-black transition-all",j===x?"bg-gradient-to-r from-[#2d5016] to-[#4a7c59] text-white shadow-lg shadow-[#2d5016]/30 border-0":"hover:bg-[#d4a574]/10 text-[#8b6f47] border-2 border-[#d4a574]/30"),children:x},x):x===j-3||x===j+3?e.jsx("span",{className:"px-1 text-[#d4a574]",children:"..."},x):null}),e.jsx("button",{disabled:j===_,onClick:()=>N(t=>Math.min(_,t+1)),className:"px-4 py-2 border-2 border-[#d4a574]/30 rounded-xl text-[10px] font-black uppercase tracking-widest disabled:opacity-30 hover:bg-[#d4a574]/10 transition-all text-[#2d5016]",children:"Sau"})]})]})]})]})},oe=({onEditOrder:i})=>{const[o,m]=r.useState([]),[d,b]=r.useState(null),[p,v]=r.useState([]),[c,g]=r.useState(!1),[f,y]=r.useState(""),[u,s]=r.useState({customerDebt:0,supplierDebt:0});r.useEffect(()=>{w.get("/api/dashboard-stats").then(a=>s({customerDebt:a.data.customer_debt||0,supplierDebt:a.data.supplier_debt||0})).catch(console.error)},[]),r.useEffect(()=>{w.get("/api/partners",{params:{search:f,limit:100}}).then(a=>m(Array.isArray(a.data)?a.data:a.data.items||[])).catch(console.error)},[f]);const n=async a=>{b(a),g(!0);try{const h=await w.get(`/api/partners/${a.id}/ledger`);v(h.data.ledger||[])}catch(h){console.error(h)}g(!1)};return e.jsxs("div",{className:"h-full flex flex-col gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-2",children:[e.jsx(S,{title:"Tổng Phải Thu",value:u.customerDebt,gradient:"bg-gradient-to-br from-[#4a7c59] to-[#87ceeb]",icon:e.jsx(K,{size:20,strokeWidth:3})}),e.jsx(S,{title:"Tổng Phải Trả",value:u.supplierDebt,gradient:"bg-gradient-to-br from-[#8b6f47] to-[#6b4423]",icon:e.jsx(R,{size:20,strokeWidth:3})})]}),e.jsxs("div",{className:"flex-1 flex gap-4 overflow-hidden",children:[e.jsxs("div",{className:"w-80 bg-white/60 dark:bg-slate-800/60 rounded-2xl border-2 border-[#d4a574]/30 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b-2 border-[#d4a574]/20",children:e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-[#8b6f47]"}),e.jsx("input",{type:"text",placeholder:"Tìm đối tác...",className:"w-full pl-9 pr-4 py-2 border-2 border-[#d4a574]/20 rounded-xl text-sm outline-none",value:f,onChange:a=>y(a.target.value)})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:o.map(a=>e.jsxs("div",{onClick:()=>n(a),className:`p-3 rounded-xl cursor-pointer mb-1 transition-all ${d?.id===a.id?"bg-[#2d5016] text-white shadow-lg":"hover:bg-[#d4a574]/10"}`,children:[e.jsx("div",{className:"font-bold text-sm",children:a.name}),e.jsxs("div",{className:`text-[10px] font-black ${d?.id===a.id?"text-white/70":"text-[#8b6f47]"}`,children:["NỢ: ",a.debt_balance.toLocaleString()," ₫"]})]},a.id))})]}),e.jsx("div",{className:"flex-1 bg-white/60 dark:bg-slate-800/60 rounded-2xl border-2 border-[#d4a574]/30 overflow-hidden flex flex-col",children:d?e.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[e.jsxs("div",{className:"p-6 bg-gradient-to-r from-[#2d5016] to-[#4a7c59] text-white",children:[e.jsx("h2",{className:"text-xl font-black uppercase tracking-tight",children:d.name}),e.jsxs("p",{className:"text-xs opacity-80 mt-1",children:["DƯ NỢ HIỆN TẠI: ",d.debt_balance.toLocaleString()," ₫"]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] uppercase text-gray-400 font-black tracking-widest border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Ngày"}),e.jsx("th",{className:"p-3",children:"Chứng từ"}),e.jsx("th",{className:"p-3",children:"Diễn giải"}),e.jsx("th",{className:"p-3 text-right",children:"Phát sinh"}),e.jsx("th",{className:"p-3 text-right",children:"Dư nợ"})]})}),e.jsx("tbody",{children:c?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center p-10",children:"Đang tải..."})}):p.map((a,h)=>e.jsxs("tr",{className:"border-b border-gray-50 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"p-3 text-xs",children:new Date(a.date).toLocaleDateString("vi-VN")}),e.jsx("td",{className:"p-3 font-bold text-[#2d5016] cursor-pointer",onClick:()=>i(a.obj),children:a.ref_id}),e.jsx("td",{className:"p-3 text-xs",children:a.desc}),e.jsx("td",{className:`p-3 text-right font-bold ${a.type==="Order"?"text-rose-600":"text-emerald-600"}`,children:a.type==="Order"?`+${a.obj.total_amount.toLocaleString()}`:`-${a.obj.amount.toLocaleString()}`}),e.jsx("td",{className:"p-3 text-right font-black",children:a.running_balance.toLocaleString()})]},h))})]})})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-400 gap-4",children:[e.jsx(G,{size:64,className:"opacity-20"}),e.jsx("p",{className:"font-bold uppercase tracking-widest text-xs",children:"Chọn đối tác để xem sổ phụ"})]})})]})]})},de=({onEditOrder:i})=>{const[o,m]=r.useState([]),[d,b]=r.useState(""),[p,v]=r.useState(null),[c,g]=r.useState([]),[f,y]=r.useState(!1);r.useEffect(()=>{const s=setTimeout(()=>{w.get("/api/products",{params:{search:d,limit:100}}).then(n=>m(Array.isArray(n.data)?n.data:n.data.items||[])).catch(console.error)},300);return()=>clearTimeout(s)},[d]);const u=async s=>{v(s),y(!0);try{const n=await w.get(`/api/products/${s.id}/history`);g(n.data)}catch(n){console.error(n)}y(!1)};return e.jsxs("div",{className:"h-full flex gap-4 overflow-hidden",children:[e.jsxs("div",{className:"w-80 bg-white/60 dark:bg-slate-800/60 rounded-2xl border-2 border-[#d4a574]/30 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b-2 border-[#d4a574]/20",children:e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-[#8b6f47]"}),e.jsx("input",{type:"text",placeholder:"Tìm sản phẩm...",className:"w-full pl-9 pr-4 py-2 border-2 border-[#d4a574]/20 rounded-xl text-sm outline-none",value:d,onChange:s=>b(s.target.value)})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2 text-xs",children:o.map(s=>e.jsxs("div",{onClick:()=>u(s),className:`p-3 rounded-xl cursor-pointer mb-1 transition-all ${p?.id===s.id?"bg-[#2d5016] text-white":"hover:bg-[#d4a574]/10"}`,children:[e.jsx("div",{className:"font-bold",children:s.name}),e.jsxs("div",{className:"opacity-70",children:["TỒN KHO: ",s.stock," ",s.unit]})]},s.id))})]}),e.jsx("div",{className:"flex-1 bg-white/60 dark:bg-slate-800/60 rounded-2xl border-2 border-[#d4a574]/30 overflow-hidden flex flex-col",children:p?e.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[e.jsxs("div",{className:"p-6 bg-gradient-to-r from-[#2d5016] to-[#4a7c59] text-white",children:[e.jsx("h2",{className:"text-xl font-black uppercase",children:p.name}),e.jsx("p",{className:"text-xs opacity-80 mt-1",children:"CHI TIẾT NHẬP XUẤT KHO"})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] uppercase text-gray-400 font-black tracking-widest border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Ngày"}),e.jsx("th",{className:"p-3",children:"Chứng từ"}),e.jsx("th",{className:"p-3",children:"Loại"}),e.jsx("th",{className:"p-3 text-right",children:"Thay đổi"})]})}),e.jsx("tbody",{children:f?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center p-10",children:"Đang tải..."})}):c.map((s,n)=>e.jsxs("tr",{className:"border-b border-gray-50 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"p-3 text-xs",children:new Date(s.date).toLocaleDateString("vi-VN")}),e.jsx("td",{className:"p-3 font-bold text-[#2d5016] cursor-pointer",onClick:()=>i(s),children:s.display_id}),e.jsx("td",{className:"p-3 text-xs font-bold uppercase",children:s.type}),e.jsx("td",{className:`p-3 text-right font-black ${s.quantity_change>0?"text-emerald-600":"text-rose-600"}`,children:s.quantity_change>0?`+${s.quantity_change}`:s.quantity_change})]},n))})]})})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-400 gap-4",children:[e.jsx(le,{size:64,className:"opacity-20"}),e.jsx("p",{className:"font-bold uppercase tracking-widest text-xs",children:"Chọn sản phẩm để xem nhật ký kho"})]})})]})};export{be as default};
